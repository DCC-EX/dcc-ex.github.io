

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>EX-RAIL Command Reference &mdash; DCC++ EX  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/dccex_theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/js/platform.js"></script>
        <script src="../_static/js/extra.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Turntable-EX (Beta)" href="../turntable-ex/index.html" />
    <link rel="prev" title="EX-RAIL Command Summary" href="EX-RAIL-summary.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../get-started/index.html">Get Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../get-started/levels.html">Choose Your Level</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/assembly.html">Assembling the Command Station</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/wifi-setup.html">Adding a WiFi Option</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/installer.html">Install using the Automated Installer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/arduino-ide.html">Install using the Arduino IDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/controllers.html">Choosing a Controller (Throttle)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/diagnosing-issues.html">Diagnosing Issues (Troubleshooting)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../advanced-setup/index.html">Advanced Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced-setup/wifi-config.html">WiFi Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-setup/motor-board-config.html">Motor Board Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-setup/startup-config.html">Startup Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-setup/supported-motorboards/index.html">Supported Motorboards Setup Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../advanced-setup/supported-motorboards/L298N-motor-board-setup.html">L298N Motor Board Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../advanced-setup/supported-motorboards/IBT_2-motor-board-setup.html">IBT_2 BTS7960 Motor Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../advanced-setup/supported-motorboards/IRF3205-motor-board-setup.html">IRF3205 Motor Board Setup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-setup/supported-microcontrollers/index.html">Supported Microcontrollers Setup Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../advanced-setup/supported-microcontrollers/wifi-mega.html">Mega+WiFi Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../advanced-setup/supported-microcontrollers/nano.html">Arduino Nano Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../advanced-setup/supported-microcontrollers/nano-every.html">Nano Every</a></li>
<li class="toctree-l3"><a class="reference internal" href="../advanced-setup/supported-microcontrollers/teensy.html">Teensy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-setup/high-accuracy.html">High Accuracy Waveform Mode</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../throttles/index.html">Throttles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../throttles/protocols.html">WiThrottle Server, Web Server, DCC++ API Explained</a></li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/ex-webthrottle.html">DCC++ EX Web Throttle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/engine-driver.html">Engine Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/withrottle.html">WiThrottle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/dccpp-cab.html">DCCpp CAB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/locontrol.html">Locontrol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/cab-engineer.html">Cab Engineer: DCC Throttle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/digitrainspro.html">DigiTrainsPro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/srcpclient.html">SRCP Client for iOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/minithrottle.html">miniThrottle (Physical)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/streamdeck.html">Elgato Stream Deck</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Automation (EX-RAIL)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="EX-RAIL-intro.html">Introduction to EX-RAIL Automation</a></li>
<li class="toctree-l2"><a class="reference internal" href="EX-RAIL-summary.html">EX-RAIL Command Summary</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">EX-RAIL Command Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../turntable-ex/index.html">Turntable-EX (Beta)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../turntable-ex/turntable-ex.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../turntable-ex/get-started.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../turntable-ex/test-and-tune.html">Testing, Tuning, and Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../turntable-ex/traverser.html">Traversers and Limited Rotation Turntables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../turntable-ex/configure.html">Configuration options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../turntable-ex/troubleshooting.html">Troubleshooting Turntable-EX</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/hardware/index.html">Hardware</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/microcontroller-boards.html">Microcontroller Boards</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/motor-boards.html">Motor Boards</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/wifi-boards.html">WiFi Boards</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/ethernet-boards.html">Ethernet Boards</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/i2c-displays.html">I2C Displays</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/i2c-devices.html">I2C Devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/gpio-module.html">I2C GPIO Expander Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/servo-module.html">Connecting a Servo Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/power-supplies.html">Power Supplies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/accessory-controllers.html">Accessory Controllers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/shopping-list.html">Shopping List</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/software/hal-config.html">I/O Device Drivers and HAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/software/hal.html">DCC++EX HAL Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/software/writing-hal-driver.html">Writing a HAL Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/software/release-notes.html">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/software/command-reference.html">DCC++ EX Command Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/software/command-summary.html">DCC++ EX Command Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/software/diagnostic-d-ack-command.html">Diagnostics <code class="docutils literal notranslate"><span class="pre">&lt;D</span> <span class="pre">ACK&gt;</span></code> Command</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/software/diagnostic-d-command.html">Diagnostics <code class="docutils literal notranslate"><span class="pre">&lt;D&gt;</span></code> Command</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/accessories/decoder-list.html">List of Tested Decoders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/accessories/suppliers.html">Hardware, Software, and Accessory Suppliers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/downloads/index.html">Downloads</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/downloads/documents.html">Documents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/downloads/schematics.html">Schematics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/tools/index.html">Diagnostic Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/tools/diagnostic-tools.html">DCC Diagnostic Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/tools/serial-monitor.html">Using a Serial Monitor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/wire-gauge.html">Wire Gauge Information</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../download/index.html">Software Downloads</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../download/commandstation.html">Command Station Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download/esp8266.html">ESP8266 Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download/dcc-inspector-ex.html">DCC Inspector-EX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download/turntable-ex.html">Turntable-EX</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../projects/index.html">Projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../projects/railsnail-bluetooth.html">RailSnail’s Complete Bluetooth DCC++EX Command Station</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer-reference/index.html">Developer and API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer-reference/tech-reference.html">Technical Reference for Throttle Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer-reference/api.html">CommandStation-EX API Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/requirements.html">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/website.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/development.html">Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/contactus.html">Contact us</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap/index.html">DCC-EX Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support/index.html">Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../support/create-ticket.html">Submit a Support Ticket</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../site-map/index.html">Site Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../donate/index.html">Donate to Our Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../press/index.html">Press</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../press/v40-announce.html">DCC++EX 4.0 Release Announcement</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about/about.html">About Us - Meet the Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/rewrite.html">What’s New in DCC++ EX?</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DCC++ EX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Automation (EX-RAIL)</a> &raquo;</li>
        
      <li>EX-RAIL Command Reference</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/DCC-EX/dcc-ex.github.io/blob/sphinx/docs/automation/EX-RAIL-reference.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ex-rail-command-reference">
<h1>EX-RAIL Command Reference<a class="headerlink" href="#ex-rail-command-reference" title="Permalink to this heading">¶</a></h1>
<div class="sidebar">
<p class="sidebar-title">On this page</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#notes" id="id1">Notes</a></p></li>
<li><p><a class="reference internal" href="#interactive-diagnostics-and-control" id="id2">Interactive diagnostics and control</a></p></li>
<li><p><a class="reference internal" href="#routes-automations-and-sequences" id="id3">Routes, automations, and sequences</a></p></li>
<li><p><a class="reference internal" href="#conditional-statements" id="id4">Conditional statements</a></p></li>
<li><p><a class="reference internal" href="#aliases" id="id5">Aliases</a></p></li>
<li><p><a class="reference internal" href="#signals" id="id6">Signals</a></p></li>
<li><p><a class="reference internal" href="#turnouts" id="id7">Turnouts</a></p></li>
<li><p><a class="reference internal" href="#sensors" id="id8">Sensors</a></p></li>
<li><p><a class="reference internal" href="#output-and-servo-commands" id="id9">Output and servo commands</a></p></li>
<li><p><a class="reference internal" href="#flow-control-functions" id="id10">Flow Control Functions</a></p></li>
<li><p><a class="reference internal" href="#blocks" id="id11">Blocks</a></p></li>
<li><p><a class="reference internal" href="#command-station-functions" id="id12">Command Station Functions</a></p></li>
<li><p><a class="reference internal" href="#ex-rail-functions" id="id13">EX-RAIL Functions</a></p></li>
<li><p><a class="reference internal" href="#loco-dcc-functions" id="id14">Loco DCC Functions</a></p></li>
<li><p><a class="reference internal" href="#dcc-accessory-decoder-commands" id="id15">DCC Accessory decoder commands</a></p></li>
</ul>
</div>
</div>
<p>This is a detailed reference. For a summary version, please see <a class="reference internal" href="EX-RAIL-summary.html"><span class="doc">EX-RAIL Command Summary</span></a>.</p>
<p><a class="reference external" href="https://github.com/DCC-EX/CommandStation-EX">CommandStation-EX</a> Provides full automation and accessory control through the Extended Railroad Automation Instruction Language (EX-RAIL). First, make sure you have the latest release of the <a class="reference external" href="https://github.com/DCC-EX/CommandStation-EX">CommandStation-EX Firmware</a>.</p>
<p>See Also:</p>
<ul class="simple">
<li><p><a class="reference internal" href="EX-RAIL-intro.html"><span class="doc">Introduction to EX-RAIL</span></a></p></li>
<li><p><a class="reference internal" href="EX-RAIL-summary.html"><span class="doc">EX-RAIL Command Summary</span></a></p></li>
</ul>
<div class="section" id="notes">
<h2><a class="toc-backref" href="#id1">Notes</a><a class="headerlink" href="#notes" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><em>AUTOMATION</em>, <em>ROUTE</em>, and <em>SEQUENCE</em> use the same ID number space, so a <code class="docutils literal notranslate"><span class="pre">FOLLOW(n)</span></code> command can be used for any of them.</p></li>
<li><p>Sensors and outputs used by AT/AFTER/SET/RESET/LATCH/UNLATCH/SERVO/IF/IFNOT refer directly to Arduino pins, and those handled by I2C expansion (as virtual pins or vpins).</p></li>
<li><p>Signals also refer directly to pins, and the signal ID (for RED/AMBER/GREEN) is always the same as the RED signal pin.</p></li>
<li><p>It’s OK to use sensor IDs that have no physical item in the layout. These can only be LATCHed, tested (IF/IFNOT), or UNLATCHed in the scripts. If a sensor is latched by the script, it can only be unlatched by the script… so <code class="docutils literal notranslate"><span class="pre">AT(35)</span> <span class="pre">LATCH(35)</span></code> for example, effectively latches sensor 35 on when detected once.</p></li>
<li><p>All IDs used in commands and functions will be numbers, or an ALIAS name if configured.</p></li>
<li><p>Most IDs simply need to be unique, however RESERVE/FREE and LATCH/UNLATCH must be in the range 0 - 255.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are four uses of ID numbers in EX-RAIL:</p>
<ul class="simple">
<li><p>AUTOMATION, ROUTE, and SEQUENCE IDs</p></li>
<li><p>Turnout IDs</p></li>
<li><p>Pin IDs - Includes physical pins on the CommandStation, virtual pins (Vpins) on I/O expander modules, and virtual pins that have no physical presence</p></li>
<li><p>Virtual block IDs as used in RESERVE/FREE</p></li>
</ul>
<p>Therefore, you can have an AUTOMATION, a turnout, a Vpin, and a virtual block all defined with the same ID without issue as these will not relate to each other. This is probably a great reason to consider aliases to avoid confusion.</p>
</div>
</div>
<div class="section" id="interactive-diagnostics-and-control">
<h2><a class="toc-backref" href="#id2">Interactive diagnostics and control</a><a class="headerlink" href="#interactive-diagnostics-and-control" title="Permalink to this heading">¶</a></h2>
<p>There are some diagnostic and control commands added to the &lt;tag&gt; language normally used to control the Command Station over USB, WiFi, or Ethernet.</p>
<p>These can be used in the same manner as other CommandStation directives to interact with EX-RAIL sequences and objects once they have been defined in myAutomation.h and are uploaded to the CommandStation.</p>
<div class="section" id="exrail">
<h3>EXRAIL<a class="headerlink" href="#exrail" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">&lt;D</span> <span class="pre">EXRAIL</span> <span class="pre">ON|OFF&gt;</span></code> When the CommandStation is connected to a serial monitor, EX-RAIL script logging can be turned on or off (Enabled or Disabled).</p>
<p>Example output from <a class="reference internal" href="EX-RAIL-intro.html#example-6-single-line-shuttle"><span class="std std-ref">Example 6: Single line shuttle</span></a> running SEQUENCE(13) with loco ID 18:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;D EXRAIL ON&gt;
&lt;p1 MAIN&gt;
PPA1
&lt;1 18 0 178 0&gt;
&lt;* EXRAIL Sensor 42 hit *&gt;
&lt;* EXRAIL Sensor 42 hit *&gt;
&lt;* EXRAIL drive 18 0 1 *&gt;
&lt;1 18 0 128 0&gt;
&lt;* EXRAIL drive 18 20 0 *&gt;
&lt;1 18 0 20 0&gt;
&lt;* EXRAIL Sensor 41 hit *&gt;
&lt;* EXRAIL Sensor 41 hit *&gt;
&lt;* EXRAIL drive 18 0 0 *&gt;
&lt;1 18 0 0 0&gt;
&lt;* EXRAIL begin(13) *&gt;
&lt;* EXRAIL begin(13) *&gt;
&lt;* EXRAIL drive 18 50 1 *&gt;
&lt;1 18 0 178 0&gt;
</pre></div>
</div>
</div>
<div class="section" id="pause-resume">
<h3>PAUSE/RESUME<a class="headerlink" href="#pause-resume" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">&lt;/PAUSE&gt;</span></code> Pauses <strong>ALL</strong> EX-RAIL automation activities, including sending an E-STOP to all locos.</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;/RESUME&gt;</span></code> Resumes <strong>ALL</strong> EX-RAIL automation activities, and resumes all locos at the same speed at which they were paused.</p>
</div>
<div class="section" id="task-info">
<h3>Task info<a class="headerlink" href="#task-info" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">&lt;/&gt;</span></code> Displays EX-RAIL running task information</p>
<p>Example outputs also using <a class="reference internal" href="EX-RAIL-intro.html#example-6-single-line-shuttle"><span class="std std-ref">Example 6: Single line shuttle</span></a>:</p>
<ul class="simple">
<li><p>Leaving right side of the shuttle sequence with speed 50F (forward):</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;/&gt;
&lt;1 18 0 178 0&gt;
&lt;* EXRAIL STATUS
ID=0,PC=12,LOCO=0 ,SPEED=0F
ID=1,PC=12,LOCO=18 ,SPEED=50F *&gt;
</pre></div>
</div>
</div>
<div class="section" id="routes">
<h3>ROUTES<a class="headerlink" href="#routes" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">&lt;/</span> <span class="pre">ROUTES&gt;</span></code>  Returns the Routes &amp; Automations control list in WiThrottle format.</p>
<p>Example output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;/ROUTES PRT]\[Routes}|{Route]\[Set}|{2]\[Handoff}|{4
PRL]\[R1}|{Example 1: Coal Yard exit}|{2]\[A4}|{Example 4: Round in circles}|{4]\[A5}|{Example 5: Round in circles}|{4&gt;
</pre></div>
</div>
</div>
<div class="section" id="start-kill">
<h3>START/KILL<a class="headerlink" href="#start-kill" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">&lt;/</span> <span class="pre">START</span> <span class="pre">[loco_addr]</span> <span class="pre">route_id&gt;</span></code>      Starts a new task to send a loco onto a Route, or activate a non-loco Animation or Sequence</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;/</span> <span class="pre">KILL</span> <span class="pre">task_id&gt;</span></code>    Kills a currently running script task by ID (use to list task IDs)</p>
</div>
<div class="section" id="reserve-free">
<h3>RESERVE/FREE<a class="headerlink" href="#reserve-free" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">&lt;/</span> <span class="pre">RESERVE</span> <span class="pre">block_id&gt;</span></code>        Manually reserves a virtual track Block, valid IDs are in the range 0 - 255.</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;/</span> <span class="pre">FREE</span> <span class="pre">block_id&gt;</span></code>   Manually frees a virtual track Block, valid IDs are in the range 0 - 255.</p>
</div>
<div class="section" id="latch-unlatch">
<h3>LATCH/UNLATCH<a class="headerlink" href="#latch-unlatch" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">&lt;/</span> <span class="pre">LATCH</span> <span class="pre">sensor_id&gt;</span></code> Lock sensor ON, preventing external influence, valid IDs are in the range 0 - 255.</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;/</span> <span class="pre">UNLATCH</span> <span class="pre">sensor_id&gt;</span></code>       Unlock sensor, returning to current external state, valid IDs are in the range 0 - 255.</p>
<p>Refer to the LATCH/UNLATCH commands in the <a class="reference internal" href="#sensors"><span class="std std-ref">Sensors</span></a> section below for further details.</p>
</div>
</div>
<div class="section" id="routes-automations-and-sequences">
<h2><a class="toc-backref" href="#id3">Routes, automations, and sequences</a><a class="headerlink" href="#routes-automations-and-sequences" title="Permalink to this heading">¶</a></h2>
<p>EX-RAIL provides many commands to allow you to create automated sequences and routes that locomotives can follow that may involve turnouts, signals, etc. that can be automatically set to react when the loco trips a sensor.</p>
<div class="section" id="script-definition-terms">
<h3>Script Definition Terms<a class="headerlink" href="#script-definition-terms" title="Permalink to this heading">¶</a></h3>
<p>There are three options to define these automation sequences:</p>
<p><code class="docutils literal notranslate"><span class="pre">AUTOMATION(</span> <span class="pre">id,</span> <span class="pre">&quot;description&quot;</span> <span class="pre">)</span></code>     Define an automation sequence that is advertised to WiThrottles to send a train along. See <a class="reference internal" href="EX-RAIL-intro.html#example-4-automating-a-train-simple-loop"><span class="std std-ref">Example 4: Automating a train (simple loop)</span></a> for a simple example.</p>
<p><code class="docutils literal notranslate"><span class="pre">ROUTE(</span> <span class="pre">id,</span> <span class="pre">&quot;description&quot;</span> <span class="pre">)</span></code>  Define a route that is advertised to WiThrottles. This can be used to initiate automation sequences such as setting turnouts and signals to allow a train to be driven through a specific route on the layout. See <a class="reference internal" href="EX-RAIL-intro.html#example-1-creating-routes-for-a-throttle"><span class="std std-ref">Example 1: Creating Routes for a Throttle</span></a> for various examples.</p>
<p><code class="docutils literal notranslate"><span class="pre">SEQUENCE(</span> <span class="pre">id</span> <span class="pre">)</span></code>      A general purpose automation sequence that is not advertised to WiThrottles. This may be triggered automatically on startup, or be called by other sequences or activites. See <a class="reference internal" href="EX-RAIL-intro.html#example-3-automating-various-non-track-items"><span class="std std-ref">Example 3: Automating various non-track items</span></a>, <a class="reference internal" href="EX-RAIL-intro.html#example-6-single-line-shuttle"><span class="std std-ref">Example 6: Single line shuttle</span></a>, and <a class="reference internal" href="EX-RAIL-intro.html#example-7-running-multiple-inter-connected-trains"><span class="std std-ref">Example 7: Running multiple inter-connected trains</span></a> for further examples.</p>
<p><code class="docutils literal notranslate"><span class="pre">ENDTASK</span></code> or <code class="docutils literal notranslate"><span class="pre">DONE</span></code> Completes a Sequence/Route/Animation/Event handler, and any other automation definition as shown in the various examples on this page and elsewhere in the EX-RAIL documentation.</p>
</div>
</div>
<div class="section" id="conditional-statements">
<h2><a class="toc-backref" href="#id4">Conditional statements</a><a class="headerlink" href="#conditional-statements" title="Permalink to this heading">¶</a></h2>
<p>There is quite a variety of conditional statements available to influence activities based on the states of sensors, signals, turnouts, and other items.</p>
<p>All conditional activities must be terminated with an <cite>ENDIF</cite> statement, and may optionally include an <cite>ELSE</cite> statement.</p>
<p>If a conditional statement is part of an automation sequence, the sequence still needs to be terminated with a DONE statement.</p>
<p><code class="docutils literal notranslate"><span class="pre">ELSE</span></code>        Provides alternative logic to any IF related command returning False.</p>
<p><code class="docutils literal notranslate"><span class="pre">ENDIF</span></code>       Required to end an IF/IFNOT/etc (Used in all IF.. functions).</p>
</div>
<div class="section" id="aliases">
<h2><a class="toc-backref" href="#id5">Aliases</a><a class="headerlink" href="#aliases" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ALIAS(</span> <span class="pre">name[,</span> <span class="pre">value]</span> <span class="pre">)</span></code>      Aliases assigns names to values. They can go anywhere in the script. If a value is not assigned, a unique ID will be assigned based on the alias “name” text.</p>
<p>This is a simple substitution that lets you have readable names for things in your script. For example, instead of having to remember the VPin a turnout is connected to, give the pin number an alias and refer to it by that name. You can use this to name routes, values, pin numbers, or anything you need.</p>
<p>If you simply need a unique identifier for an object used internally to the script, such as a turnout, route, automation, or sequence, you don’t even need to provide an ID, EX-RAIL will generate one automatically when you omit the value parameter. We recommend using this for all your routes, sequences, and other internal objects so you don’t have to try to remember or keep a list of numbers you’ve used. This also prevents you from assigning the same number to more than one object.</p>
<p>REMEMBER: IDs for RESERVE/FREE, LATCH/UNLATCH, and pins must be explicitly defined.</p>
<p>To put this another way, if you connect an LED to pin 23 and want to turn it on and off, you have to explicitly set its pin number, so <cite>ALIAS(TOWER_LED, 23)</cite> lets you equate “23” to TOWER_LED. But if you created a route to run your train around an oval, you don’t really need to set the number or even know it. Just use <cite>ALIAS(OVAL)</cite> and let EX assign a number internally. If you ever wanted to know what number it assigns, you can enter <cite>&lt;? OVAL&gt;</cite> from the serial monitor with the Command Station running and it will tell you next to “Opcode=”. Since this “hash”, as it is called, is generated by the alias name word, it is always unique and always the same for that word even if you have not created the alias yet. Fun fact, “OVAL” will always equal 27500.</p>
<p>Alias naming rules:</p>
<ul class="simple">
<li><p><strong>Must not</strong> be an existing EX-RAIL command name or other reserved word.</p></li>
<li><p><strong>Should be</strong> reasonably short but descriptive.</p></li>
<li><p><strong>Must start</strong> with letters A-Z, a-z, or underscore _ (case sensitive!).</p></li>
<li><p><strong>May then</strong> also contain numbers.</p></li>
<li><p><strong>Must not</strong> contain spaces or special characters.</p></li>
</ul>
<p>Examples:</p>
<p>Defining a pin turnout without an alias:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">PIN_TURNOUT</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="s">&quot;Coal Yard&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Defining a pin turnout with aliases:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ALIAS</span><span class="p">(</span><span class="n">COAL_YARD</span><span class="p">)</span>
<span class="n">ALIAS</span><span class="p">(</span><span class="n">COAL_YARD_PIN</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">PIN_TURNOUT</span><span class="p">(</span><span class="n">COAL_YARD</span><span class="p">,</span> <span class="n">COAL_YARD_PIN</span><span class="p">,</span> <span class="s">&quot;Coal Yard&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that you could have used the command <cite>ALIAS(COAL_YARD, 1)</cite> in the example above to explicity set the number, but unless you have a reason to use specific numbers, let the Command Station do it for you.</p>
<p>In this simple example, aliases seem like overkill, however consider the case where you need to have the “Coal Yard” turnout closed or thrown in various different automation sequences, and you will soon see why it’s easier to understand you’re throwing the COAL_YARD turnout rather than turnout ID 12345.</p>
</div>
<div class="section" id="signals">
<h2><a class="toc-backref" href="#id6">Signals</a><a class="headerlink" href="#signals" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">SIGNAL(</span> <span class="pre">red_pin,</span> <span class="pre">amber_pin,</span> <span class="pre">green_pin</span> <span class="pre">)</span></code>     Define a pin based signal, which requires three active low pins to be defined to correspond with red, amber, and green lights.</p>
<p><code class="docutils literal notranslate"><span class="pre">SIGNALH(</span> <span class="pre">red_pin,</span> <span class="pre">amber_pin,</span> <span class="pre">green_pin</span> <span class="pre">)</span></code> As above to define a pin based signal, but with active high pins instead.</p>
<p>For both the SIGNAL/SIGNALH commands, signal colour is set using the pin defined for the red pin. If the signal only has two colours (eg. RED/GREEN), set the unused colour’s pin to 0.</p>
<p><code class="docutils literal notranslate"><span class="pre">SERVO_SIGNAL(</span> <span class="pre">vpin,</span> <span class="pre">red_pos,</span> <span class="pre">amber_pos,</span> <span class="pre">green_pos</span> <span class="pre">)</span></code> Define a servo based signal, such as semaphore signals. Each position is an angle to turn the servo to, similar to the SERVO/SERVO2 commands, and SERVO_TURNOUT.</p>
<p><code class="docutils literal notranslate"><span class="pre">IFRED(</span> <span class="pre">signal_id</span> <span class="pre">)</span></code> Test if signal is red.</p>
<p><code class="docutils literal notranslate"><span class="pre">IFAMBER(</span> <span class="pre">signal_id</span> <span class="pre">)</span></code> Test if signal is amber.</p>
<p><code class="docutils literal notranslate"><span class="pre">IFGREEN(</span> <span class="pre">signal_id</span> <span class="pre">)</span></code> Test if signal is green.</p>
<p>Signal examples:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">SIGNAL</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">)</span>                <span class="c1">// Active low red/amber/green signal using pins 25/26/27 directly on the CommandStation.</span>
<span class="n">SIGNALH</span><span class="p">(</span><span class="mi">164</span> <span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">165</span><span class="p">)</span>              <span class="c1">// Active high red/green signal using the first two pins of an MCP23017 I/O expander module.</span>
<span class="n">SERVO_SIGNAL</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>  <span class="c1">// Servo based signal using the first PCA9685 servo module.</span>

<span class="n">GREEN</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>                         <span class="c1">// Sets our active low signal to green.</span>
<span class="n">GREEN</span><span class="p">(</span><span class="mi">164</span><span class="p">)</span>                         <span class="c1">// Sets our active high signal to green.</span>
<span class="n">GREEN</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>                        <span class="c1">// Sets our servo based signal to green.</span>
</pre></div>
</div>
</div>
<div class="section" id="turnouts">
<h2><a class="toc-backref" href="#id7">Turnouts</a><a class="headerlink" href="#turnouts" title="Permalink to this heading">¶</a></h2>
<p>All the below turnout definitions will define turnouts that are advertised to WiThrottle apps, Engine Driver, and JMRI, unless the HIDDEN keyword is used.</p>
<p>“description” is an optional parameter, and must be enclosed in quotes “”. If you don’t wish this turnout to be advertised to throttles, then substitute the word HIDDEN (with no “”) instead of the description.</p>
<p><code class="docutils literal notranslate"><span class="pre">TURNOUT(</span> <span class="pre">id,</span> <span class="pre">addr,</span> <span class="pre">sub_addr</span> <span class="pre">[,</span> <span class="pre">&quot;description&quot;]</span> <span class="pre">)</span></code>     Define a DCC accessory turnout. Note that DCC linear addresses are not supported, and must be converted to address/subaddress in order to be defined. Refer to the <a class="reference internal" href="../reference/downloads/documents.html#stationary-decoder-address-table-xlsx-spreadsheet"><span class="std std-ref">Stationary Decoder Address Table (xlsx Spreadsheet)</span></a> for help on these conversions.</p>
<p><code class="docutils literal notranslate"><span class="pre">PIN_TURNOUT(</span> <span class="pre">id,</span> <span class="pre">pin</span> <span class="pre">[,</span> <span class="pre">&quot;description&quot;]</span> <span class="pre">)</span></code>    Define a pin operated turnout. When sending a CLOSE command, the pin will be HIGH, and a THROW command will set the pin LOW.</p>
<p><code class="docutils literal notranslate"><span class="pre">SERVO_TURNOUT(</span> <span class="pre">id,</span> <span class="pre">pin,</span> <span class="pre">active_angle,</span> <span class="pre">inactive_angle,</span> <span class="pre">profile</span> <span class="pre">[,</span> <span class="pre">&quot;description&quot;]</span> <span class="pre">)</span></code>   Define a servo turnout. “active_angle” is for THROW, “inactive_angle” is for CLOSE, and profile is one of Instant, Fast, Medium, Slow or Bounce (although clearly we don’t recommend Bounce for turnouts!). Refer to <a class="reference internal" href="../reference/hardware/servo-module.html"><span class="doc">Connecting a Servo Module</span></a> for more information.</p>
<p><code class="docutils literal notranslate"><span class="pre">VIRTUAL_TURNOUT(</span> <span class="pre">id</span> <span class="pre">[,</span> <span class="pre">&quot;description&quot;]</span> <span class="pre">)</span></code> Define a virtual turnout, which is backed by another automation sequence. For a good example of this refer to <a class="reference internal" href="EX-RAIL-intro.html#realistic-turnout-sequeunces"><span class="std std-ref">Realistic turnout sequeunces</span></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">IFCLOSED(</span> <span class="pre">turnout_id</span> <span class="pre">)</span></code>      Test if a turnout is closed.</p>
<p><code class="docutils literal notranslate"><span class="pre">IFTHROWN(</span> <span class="pre">turnout_id</span> <span class="pre">)</span></code>      Test if a turnout is thrown.</p>
<p><code class="docutils literal notranslate"><span class="pre">ONCLOSE(</span> <span class="pre">turnout_id</span> <span class="pre">)</span></code>       Event handler for when a turnout is sent a close command. Note that there can be only one defined ONCLOSE event for a specific turnout.</p>
<p><code class="docutils literal notranslate"><span class="pre">ONTHROW(</span> <span class="pre">turnout_id</span> <span class="pre">)</span></code>       Event handler for when a turnout is sent a throw command. Note that there can be only one defined ONTHROW event for a specific turnout.</p>
<p>Examples:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">TURNOUT</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Coal Yard&quot;</span><span class="p">)</span>                  <span class="c1">// DCC accessory turnout at linear address 101.</span>
<span class="n">PIN_TURNOUT</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="s">&quot;Switching Yard&quot;</span><span class="p">)</span>           <span class="c1">// Pin turnout on an MCP23017 I/O expander module.</span>
<span class="n">SERVO_TURNOUT</span><span class="p">(</span><span class="mi">102</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">Slow</span><span class="p">,</span> <span class="n">HIDDEN</span><span class="p">)</span>   <span class="c1">// A servo turnout on a PCA9685 servo module that is hidden from throttles.</span>
<span class="n">VIRTUAL_TURNOUT</span><span class="p">(</span><span class="mi">103</span><span class="p">,</span> <span class="s">&quot;Lumber Yard&quot;</span><span class="p">)</span>               <span class="c1">// A virtual turnout which will trigger an automation sequence when CLOSE or THROW is sent.</span>
</pre></div>
</div>
</div>
<div class="section" id="sensors">
<h2><a class="toc-backref" href="#id8">Sensors</a><a class="headerlink" href="#sensors" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">AT(</span> <span class="pre">sensor_id</span> <span class="pre">)</span></code> An event handler that defines what to do when a sensor is active/triggered.</p>
<p><code class="docutils literal notranslate"><span class="pre">AFTER(</span> <span class="pre">sensor_id</span> <span class="pre">)</span></code>  An event handler that defines what to do after a sensor has been triggered and then is off for 0.5 seconds.</p>
<p><code class="docutils literal notranslate"><span class="pre">ATTIMEOUT(</span> <span class="pre">sensor_id,</span> <span class="pre">timeout_ms</span> <span class="pre">)</span></code>  A time based event handler that defines what to do when a sensor is active/triggered or if the timer runs out, then continues and sets a testable “timed out” flag.</p>
<p><code class="docutils literal notranslate"><span class="pre">IF(</span> <span class="pre">sensor_id</span> <span class="pre">)</span></code>     If sensor activated or latched, continue. Otherwise skip to ELSE or matching ENDIF.</p>
<p><code class="docutils literal notranslate"><span class="pre">IFNOT(</span> <span class="pre">sensor_id</span> <span class="pre">)</span></code>  If sensor NOT activated and NOT latched, continue. Otherwise skip to ELSE or matching ENDIF.</p>
<p><code class="docutils literal notranslate"><span class="pre">IFTIMEOUT</span></code>   Tests if “timed out” flag has been set by an ATTIMEOUT() sensor reading attempt.</p>
<p>Note that with the sensor commands <cite>IF()</cite>, <cite>IFNOT()</cite>, <cite>IFTIMEOUT()</cite>, <cite>AT()</cite>, <cite>ATTIMEOUT()</cite>, and <cite>AFTER()</cite>, you can use negative values to enable the use of active HIGH sensors.</p>
<p>For example:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">AT</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>        <span class="c1">// Wait for pin 40 to go low.</span>
<span class="n">AT</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">)</span>       <span class="c1">// Wait for pin 40 to go high.</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ATGTE(</span> <span class="pre">analogpin,</span> <span class="pre">value</span> <span class="pre">)</span></code>  Waits for an analog pin to reach the specified value.</p>
<p><code class="docutils literal notranslate"><span class="pre">ATLT</span> <span class="pre">(</span> <span class="pre">analogpin,</span> <span class="pre">value</span> <span class="pre">)</span></code> Waits for an analog pin to go below the specified value.</p>
<p><code class="docutils literal notranslate"><span class="pre">IFGTE(</span> <span class="pre">sensor_id,</span> <span class="pre">value</span> <span class="pre">)</span></code>   Test if analog pin reading is greater than or equal to value (&gt;=).</p>
<p><code class="docutils literal notranslate"><span class="pre">IFLT(</span> <span class="pre">sensor_id,</span> <span class="pre">value</span> <span class="pre">)</span></code>    Test if analog pin reading is less than value (&lt;).</p>
<p>All the <cite>IFGTE()</cite>, <cite>IFLT()</cite>, <cite>ATGTE()`and `ATLT()</cite> commands read the analog value from an analog input pin (A0 - A5 on an Arduino Mega) or an analog input from an I/O expander module. Valid values are defined by the capability of the analog to digital converter in use.</p>
<p>Sensor examples:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">IF</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>          <span class="c1">// If sensor on the CS pin 25 is activated, set a signal red, wait 10 seconds, then close a turnout.</span>
  <span class="n">RED</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
  <span class="n">DELAY</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
  <span class="n">CLOSE</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="n">ENDIF</span>

<span class="n">IFNOT</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>       <span class="c1">// If sensor on the CS pin 26 is not activated, keep our pedestrian crossing light at 102 green, else set it red.</span>
  <span class="n">GREEN</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>
<span class="n">ELSE</span>
  <span class="n">RED</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>
<span class="n">ENDIF</span>

<span class="n">IFGTE</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>  <span class="c1">// If reading the analog input from a photoelectric light sensor exceeds 512, it&#39;s bright enough to turn the street lights off.</span>
  <span class="n">RESET</span><span class="p">(</span><span class="mi">164</span><span class="p">)</span>
<span class="n">ENDIF</span>

<span class="n">IFLT</span><span class="p">(</span><span class="n">A3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>   <span class="c1">// If current sensing from an analog occupancy detector had dropped below the threshold, turn off our mimic panel light, otherwise turn it on.</span>
  <span class="n">RESET</span><span class="p">(</span><span class="mi">165</span><span class="p">)</span>
<span class="n">ELSE</span>
  <span class="n">SET</span><span class="p">(</span><span class="mi">165</span><span class="p">)</span>
<span class="n">ENDIF</span>
</pre></div>
</div>
<p>LATCH/UNLATCH can be used to maintain the state of a sensor, or can also be used to trigger a virtual sensor to act as a state flag for EX-RAIL. As this effects the state of a sensor, it can be tested via IF/IFNOT and will also work with AT/AFTER.</p>
<p><code class="docutils literal notranslate"><span class="pre">LATCH(</span> <span class="pre">sensor_id</span> <span class="pre">)</span></code>  Latches a sensor on (Sensors 0-255 only).</p>
<p><code class="docutils literal notranslate"><span class="pre">UNLATCH(</span> <span class="pre">sensor_id</span> <span class="pre">)</span></code>        Remove LATCH on sensor.</p>
<p>In this example, LATCH/UNLATCH is used to toggle between two different activities each time the ROUTE is selected in a WiThrottle:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>TURNOUT(17, 30, 1, &quot;Bay to Shed&quot;) // DCC turnout with linear address 117

ALIAS(BayExitStarter, 107)        // Starter Signal with Route board
ALIAS(ROUTE_TOGGLE, 11)           // State flag to toggle

ROUTE(11, &quot;Bay to Shed&quot;)
  IF(ROUTE_TOGGLE)             // If ROUTE_TOGGLE is active, reset the route
    DEACTIVATEL(BayExitStarter)
    DELAY(20)
    CLOSE(17)
    UNLATCH(ROUTE_TOGGLE)           // UNLATCH (Clear) ROUTE_TOGGLE
  ELSE                            // LATCH is not active, so set route and LATCH
    THROW(17)
    DELAY(20)
    ACTIVATEL(BayExitStarter)
    LATCH(ROUTE_TOGGLE)         // LATCH ROUTE_TOGGLE to indicate route set
  ENDIF
DONE
</pre></div>
</div>
</div>
<div class="section" id="output-and-servo-commands">
<h2><a class="toc-backref" href="#id9">Output and servo commands</a><a class="headerlink" href="#output-and-servo-commands" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">SET(</span> <span class="pre">pin</span> <span class="pre">)</span></code>  Set an output pin HIGH</p>
<p><code class="docutils literal notranslate"><span class="pre">RESET(</span> <span class="pre">pin</span> <span class="pre">)</span></code>        Reset output pin (set to LOW)</p>
<p><code class="docutils literal notranslate"><span class="pre">CLOSE(</span> <span class="pre">turnout_id</span> <span class="pre">)</span></code> Close a defined turnout</p>
<p><code class="docutils literal notranslate"><span class="pre">THROW(</span> <span class="pre">id</span> <span class="pre">)</span></code> Throw a defined turnout</p>
<p><code class="docutils literal notranslate"><span class="pre">GREEN(</span> <span class="pre">signal_id</span> <span class="pre">)</span></code>  Set a defined signal to GREEN (see SIGNAL)</p>
<p><code class="docutils literal notranslate"><span class="pre">AMBER(</span> <span class="pre">signal_id</span> <span class="pre">)</span></code>  Set a defined signal to Amber. (See SIGNAL)</p>
<p><code class="docutils literal notranslate"><span class="pre">RED(</span> <span class="pre">signal_id</span> <span class="pre">)</span></code>    Set defined signal to Red (See SIGNAL)</p>
<p><code class="docutils literal notranslate"><span class="pre">FADE(</span> <span class="pre">pin,</span> <span class="pre">value,</span> <span class="pre">ms</span> <span class="pre">)</span></code>      Fade an LED on a servo driver to given value taking given time</p>
<p><code class="docutils literal notranslate"><span class="pre">LCN(</span> <span class="pre">msg</span> <span class="pre">)</span></code>  Send message to LCN Accessory Network</p>
<p><code class="docutils literal notranslate"><span class="pre">SERVO(</span> <span class="pre">id,</span> <span class="pre">position,</span> <span class="pre">profile</span> <span class="pre">)</span></code>      Move an animation servo. Do NOT use for Turnouts. (profile is one of Instant, Fast, Medium, Slow or Bounce)</p>
<p><code class="docutils literal notranslate"><span class="pre">SERVO2(</span> <span class="pre">id,</span> <span class="pre">position,</span> <span class="pre">duration</span> <span class="pre">)</span></code>    Move an animation servo taking duration in ms. Do NOT use for Turnouts</p>
<p><code class="docutils literal notranslate"><span class="pre">WAITFOR(</span> <span class="pre">pin</span> <span class="pre">)</span></code>      The WAITFOR() command instructs EX-RAIL to wait for a servo motion to complete prior to continuing.</p>
<p>A couple of examples:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// First example defines a servo turnout for the coal yard and a signal for the main line.</span>
<span class="n">TURNOUT</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Coal Yard&quot;</span><span class="p">)</span>
<span class="n">SIGNAL</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">)</span>

<span class="c1">// When our turnout is closed, the main line is open, so the signal is green.</span>
<span class="n">ONCLOSE</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
  <span class="n">GREEN</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="n">DONE</span>

<span class="c1">// When our turnout is closed, the main line is interrupted, so the signal is red.</span>
<span class="n">ONTHROW</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
  <span class="n">RED</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="n">DONE</span>

<span class="c1">// This example triggers an automation sequence when a DCC accessory decoder is activated, including waiting for SERVO motions to complete.</span>
<span class="n">ONACTIVATEL</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>            <span class="c1">// Activating DCC accessory decoder with linear address 100 commences the sequence.</span>
  <span class="n">SERVO</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="n">Slow</span><span class="p">)</span>     <span class="c1">// Move the first servo and wait.</span>
  <span class="n">WAITFOR</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
  <span class="n">SERVO</span><span class="p">(</span><span class="mi">102</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="n">Medium</span><span class="p">)</span>   <span class="c1">// Move the second servo and wait.</span>
  <span class="n">WAITFOR</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>
  <span class="n">SET</span><span class="p">(</span><span class="mi">165</span><span class="p">)</span>                  <span class="c1">// Activate a Vpin to turn an LED on.</span>
  <span class="n">SET</span><span class="p">(</span><span class="mi">166</span><span class="p">)</span>                  <span class="c1">// Activate a second Vpin to turn a second LED on.</span>
<span class="n">DONE</span>
</pre></div>
</div>
</div>
<div class="section" id="flow-control-functions">
<h2><a class="toc-backref" href="#id10">Flow Control Functions</a><a class="headerlink" href="#flow-control-functions" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">CALL(</span> <span class="pre">route</span> <span class="pre">)</span></code>       Branch to a separate sequence, which will need to RETURN when complete.</p>
<p><code class="docutils literal notranslate"><span class="pre">RETURN</span></code>      Return to the calling sequence when completed (no DONE required).</p>
<p>Say, for example, you have an AUTOMATION you initiate the sends a train through your layout with multiple station stops, and you want to do the same things at each station.</p>
<p>You could write a very long AUTOMATION sequence to do this, or you could write the sound SEQUENCE once, then call it at each station:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">AUTOMATION</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="s">&quot;Station loop&quot;</span><span class="p">)</span>    <span class="c1">// Our station loop sequence</span>
  <span class="n">FWD</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
  <span class="n">AT</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>                         <span class="c1">// At station 1 entrance sensor, call our sequence</span>
  <span class="n">CALL</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
  <span class="n">AT</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>                         <span class="c1">// At station 2 entrance sensor, call our sequence</span>
  <span class="n">CALL</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
  <span class="n">AT</span><span class="p">(</span><span class="mi">103</span><span class="p">)</span>                         <span class="c1">// At station 3 entrance sensor, call our sequence</span>
  <span class="n">CALL</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
  <span class="n">AT</span><span class="p">(</span><span class="mi">104</span><span class="p">)</span>                         <span class="c1">// At station 4 entrance sensor, call our sequence</span>
  <span class="n">CALL</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
  <span class="n">FOLLOW</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>                      <span class="c1">// Keep looping through the stations (see FOLLOW command reference below)</span>

<span class="n">SEQUENCE</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="s">&quot;Station sequence&quot;</span><span class="p">)</span>  <span class="c1">// Our station sequence</span>
  <span class="n">FON</span><span class="p">(</span><span class="n">F2</span><span class="p">)</span>                         <span class="c1">// Blow the horn</span>
  <span class="n">FON</span><span class="p">(</span><span class="n">F3</span><span class="p">)</span>                         <span class="c1">// Break squeal</span>
  <span class="n">STOP</span>                            <span class="c1">// Stop at the station</span>
  <span class="n">FON</span><span class="p">(</span><span class="n">F4</span><span class="p">)</span>                         <span class="c1">// Let out a hiss from the air breaks for a second</span>
  <span class="n">DELAY</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
  <span class="n">FOFF</span><span class="p">(</span><span class="n">F4</span><span class="p">)</span>
  <span class="n">DELAYRANDOM</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>        <span class="c1">// Wait between 2 and 10 seconds for passengers</span>
  <span class="n">FON</span><span class="p">(</span><span class="n">F2</span><span class="p">)</span>                         <span class="c1">// Blow the horn again</span>
  <span class="n">FWD</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>                         <span class="c1">// On our way to the next station</span>
  <span class="n">RETURN</span>                          <span class="c1">// Return to the calling sequence</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">FOLLOW(</span> <span class="pre">route</span> <span class="pre">)</span></code>     Branch or Follow a numbered sequence. This lets us do clever things like performing a different sequence depending on whether a turnout is CLOSED or THROWN, as well as simple things such as the example above where we keep looping through the same sequence.</p>
<p>For example:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">AUTOMATION</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="s">&quot;Choose your own adventure&quot;</span><span class="p">)</span> <span class="c1">// This let&#39;s someone control the sequence by throwing a turnout (or not)</span>
  <span class="n">FWD</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
  <span class="n">AFTER</span><span class="p">(</span><span class="mi">105</span><span class="p">)</span>
  <span class="n">IFTHROWN</span><span class="p">(</span><span class="mi">106</span><span class="p">)</span>
    <span class="n">FOLLOW</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
  <span class="n">ELSE</span>
    <span class="n">FOLLOW</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
  <span class="n">ENDIF</span>
  <span class="n">DONE</span>

<span class="n">SEQUENCE</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="s">&quot;Adventure 1&quot;</span><span class="p">)</span>                 <span class="c1">// Quite a boring adventure to stop in a siding after sensor 106 has activated/deactivated</span>
  <span class="n">AFTER</span><span class="p">(</span><span class="mi">106</span><span class="p">)</span>
  <span class="n">FON</span><span class="p">(</span><span class="n">F2</span><span class="p">)</span>
  <span class="n">FON</span><span class="p">(</span><span class="n">F3</span><span class="p">)</span>
  <span class="n">STOP</span>
  <span class="n">DONE</span>

<span class="n">SEQUENCE</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="s">&quot;Adventure 2&quot;</span><span class="p">)</span>                 <span class="c1">// If we don&#39;t throw the turnout, let&#39;s do our station loop from the example above</span>
  <span class="n">FOLLOW</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">DELAY(</span> <span class="pre">delay</span> <span class="pre">)</span></code>      Delay a number of milliseconds</p>
<p><code class="docutils literal notranslate"><span class="pre">DELAYMINS(</span> <span class="pre">delay</span> <span class="pre">)</span></code>  Delay a number of minutes</p>
<p><code class="docutils literal notranslate"><span class="pre">DELAYRANDOM(</span> <span class="pre">min_delay,</span> <span class="pre">max_delay</span> <span class="pre">)</span></code> Delay a random time between min and max milliseconds, see <a class="reference internal" href="EX-RAIL-intro.html#example-7-running-multiple-inter-connected-trains"><span class="std std-ref">Example 7: Running multiple inter-connected trains</span></a> for good examples.</p>
<p>Delay examples:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ONCLOSE</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>      <span class="c1">// When turnout 102 closed, wait 2 seconds, then set signal 101 green.</span>
  <span class="n">DELAY</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
  <span class="n">GREEN</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
  <span class="n">DONE</span>

<span class="n">AT</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>           <span class="c1">// When sensor 123 is activated, set signal 102 red, wait 1 minute, then set signal 102 green.</span>
  <span class="n">RED</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>
  <span class="n">DELAYMINS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">GREEN</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>
  <span class="n">DONE</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">IFRANDOM(</span> <span class="pre">percent</span> <span class="pre">)</span></code> Runs commands in IF block a random percentage of the time. This is handy for more realism by enabling automations that don’t have to run on a schedule.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">AT</span><span class="p">(</span><span class="mi">165</span><span class="p">)</span>           <span class="c1">// When sensor 165 is activated, set a lineside merry-go-round in action for 1 minute 50% of the time.</span>
  <span class="n">IFRANDOM</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">SET</span><span class="p">(</span><span class="mi">166</span><span class="p">)</span>
    <span class="n">DELAYMINS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">RESET</span><span class="p">(</span><span class="mi">166</span><span class="p">)</span>
  <span class="n">ENDIF</span>
  <span class="n">DONE</span>
</pre></div>
</div>
</div>
<div class="section" id="blocks">
<h2><a class="toc-backref" href="#id11">Blocks</a><a class="headerlink" href="#blocks" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">RESERVE(</span> <span class="pre">block_id</span> <span class="pre">)</span></code> Reserve a block (0-255). If already reserved, current loco will STOP and script waits for block to become free</p>
<p><code class="docutils literal notranslate"><span class="pre">FREE(</span> <span class="pre">block_id</span> <span class="pre">)</span></code>    Free previously reserved block</p>
<p><code class="docutils literal notranslate"><span class="pre">IFRESERVE(</span> <span class="pre">block</span> <span class="pre">)</span></code>  If block is NOT reserved, reserves it and run commands in IF block. Otherwise, skip to matching ENDIF</p>
</div>
<div class="section" id="command-station-functions">
<h2><a class="toc-backref" href="#id12">Command Station Functions</a><a class="headerlink" href="#command-station-functions" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">POWERON</span></code> Power on track and UNJOIN (not yet implemented) - this command will be available in a future release of CommandStation-EX</p>
<p><code class="docutils literal notranslate"><span class="pre">POWEROFF</span></code>    Power off track</p>
<p><code class="docutils literal notranslate"><span class="pre">JOIN</span></code>        Joins PROG and MAIN track outputs to send the same MAIN DCC signal</p>
<p><code class="docutils literal notranslate"><span class="pre">UNJOIN</span></code>      Disconnect prog track from main</p>
<p><code class="docutils literal notranslate"><span class="pre">READ_LOCO</span></code>   Read loco ID from prog track</p>
<p><code class="docutils literal notranslate"><span class="pre">POM(</span> <span class="pre">cv,</span> <span class="pre">value</span> <span class="pre">)</span></code>    Program CV value on main</p>
<p><code class="docutils literal notranslate"><span class="pre">LCD(</span> <span class="pre">row,</span> <span class="pre">msg</span> <span class="pre">)</span></code>     Write message on LCD/OLED if fitted</p>
<p><code class="docutils literal notranslate"><span class="pre">BROADCAST(</span> <span class="pre">msg</span> <span class="pre">)</span></code> Broadcast to all throttles/JMRI on serial and WiFi</p>
<p><code class="docutils literal notranslate"><span class="pre">PRINT(</span> <span class="pre">msg</span> <span class="pre">)</span></code>        Print diagnostic message to Serial Monitor</p>
<p><code class="docutils literal notranslate"><span class="pre">SERIAL(</span> <span class="pre">msg</span> <span class="pre">)</span></code>       Writes direct to Serial (Serial0/USB)</p>
<p><code class="docutils literal notranslate"><span class="pre">SERIAL1(</span> <span class="pre">msg</span> <span class="pre">)</span></code>      Writes direct to Serial1</p>
<p><code class="docutils literal notranslate"><span class="pre">SERIAL2(</span> <span class="pre">msg</span> <span class="pre">)</span></code>      Wri1tes direct to Seria2</p>
<p><code class="docutils literal notranslate"><span class="pre">SERIAL3(</span> <span class="pre">msg</span> <span class="pre">)</span></code>      Writes direct to Serial3</p>
</div>
<div class="section" id="ex-rail-functions">
<h2><a class="toc-backref" href="#id13">EX-RAIL Functions</a><a class="headerlink" href="#ex-rail-functions" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">PAUSE</span></code>       E-STOP all locos and PAUSE all other EX-RAIL tasks until RESUMEd</p>
<p><code class="docutils literal notranslate"><span class="pre">RESUME</span></code>      Resume all paused tasks, including loco movement</p>
<p><code class="docutils literal notranslate"><span class="pre">START(</span> <span class="pre">sequence_id</span> <span class="pre">)</span></code>        Start a new task to execute a route or sequence</p>
<p><code class="docutils literal notranslate"><span class="pre">SETLOCO(</span> <span class="pre">loco</span> <span class="pre">)</span></code>     Set the loco address for this task</p>
<p><code class="docutils literal notranslate"><span class="pre">SENDLOCO(</span> <span class="pre">cab,</span> <span class="pre">route</span> <span class="pre">)</span></code>      Start a new task send a given loco along given route/sequence</p>
<p><code class="docutils literal notranslate"><span class="pre">AUTOSTART</span></code>   A task is automatically started at this point during startup</p>
<p><code class="docutils literal notranslate"><span class="pre">DRIVE(</span> <span class="pre">analog_pin</span> <span class="pre">)</span></code> Not complete, DO NOT USE</p>
<p><code class="docutils literal notranslate"><span class="pre">ROSTER(</span> <span class="pre">cab,</span> <span class="pre">name,</span> <span class="pre">func_map</span> <span class="pre">)</span></code>       Provide roster info for WiThrottle</p>
</div>
<div class="section" id="loco-dcc-functions">
<h2><a class="toc-backref" href="#id14">Loco DCC Functions</a><a class="headerlink" href="#loco-dcc-functions" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ESTOP</span></code>       Emergency stop loco</p>
<p><code class="docutils literal notranslate"><span class="pre">FWD(</span> <span class="pre">speed</span> <span class="pre">)</span></code>        Drive loco forward at DCC speed 0-127 (1=ESTOP)</p>
<p><code class="docutils literal notranslate"><span class="pre">REV(</span> <span class="pre">speed</span> <span class="pre">)</span></code>        Drive logo in reverse at DCC speed 0-127 (1=ESTOP)</p>
<p><code class="docutils literal notranslate"><span class="pre">SPEED(</span> <span class="pre">speed</span> <span class="pre">)</span></code>      Drive loco in current direction at DCC speed (0-127)</p>
<p><code class="docutils literal notranslate"><span class="pre">STOP</span></code>        Set loco speed to 0 (same as SPEED(0) )</p>
<p><code class="docutils literal notranslate"><span class="pre">FON(</span> <span class="pre">func</span> <span class="pre">)</span></code> Turn on loco function</p>
<p><code class="docutils literal notranslate"><span class="pre">FOFF(</span> <span class="pre">func</span> <span class="pre">)</span></code>        Turn off loco function</p>
<p><code class="docutils literal notranslate"><span class="pre">INVERT_DIRECTION</span></code>    Switches FWD/REV meaning for this loco</p>
</div>
<div class="section" id="dcc-accessory-decoder-commands">
<h2><a class="toc-backref" href="#id15">DCC Accessory decoder commands</a><a class="headerlink" href="#dcc-accessory-decoder-commands" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ONACTIVATE(</span> <span class="pre">addr,</span> <span class="pre">sub_addr</span> <span class="pre">)</span></code>        Event handler for 2 part DCC accessory packet value 1</p>
<p><code class="docutils literal notranslate"><span class="pre">ONACTIVATEL(</span> <span class="pre">linear</span> <span class="pre">)</span></code>       Event handler for linear DCC accessory packet value 1</p>
<p><code class="docutils literal notranslate"><span class="pre">ONDEACTIVATE(</span> <span class="pre">addr,</span> <span class="pre">sub_addr</span> <span class="pre">)</span></code>      Event handler for 2 part DCC accessory packet value 0</p>
<p><code class="docutils literal notranslate"><span class="pre">ONDEACTIVATEL(</span> <span class="pre">linear</span> <span class="pre">)</span></code>     Event handler for linear DCC accessory packet value 0</p>
<p><code class="docutils literal notranslate"><span class="pre">ACTIVATE(</span> <span class="pre">addr,</span> <span class="pre">sub_addr</span> <span class="pre">)</span></code>  Sends a DCC accessory packet with value 1</p>
<p><code class="docutils literal notranslate"><span class="pre">ACTIVATEL(</span> <span class="pre">linear</span> <span class="pre">)</span></code> Sends a DCC accessory packet with value 1 to a linear address</p>
<p><code class="docutils literal notranslate"><span class="pre">DEACTIVATE(</span> <span class="pre">addr,</span> <span class="pre">sub_addr</span> <span class="pre">)</span></code>        Sends a DCC accessory packet with value 0</p>
<p><code class="docutils literal notranslate"><span class="pre">DEACTIVATEL(</span> <span class="pre">addr</span> <span class="pre">)</span></code> Sends a DCC accessory packet with value 0 to a linear address</p>
<p><code class="docutils literal notranslate"><span class="pre">XFON(</span> <span class="pre">cab,</span> <span class="pre">func</span> <span class="pre">)</span></code>   Send DCC function ON to specific cab (eg coach lights) Not for Loco use - use FON instead!</p>
<p><code class="docutils literal notranslate"><span class="pre">XFOFF(</span> <span class="pre">cab,</span> <span class="pre">func</span> <span class="pre">)</span></code>  Send DCC function OFF to specific cab (eg coach lights) Not for Loco use - use FON instead!</p>
<p>All the above “ON” commands are event handlers that trigger a sequence of commands to run when the event occurs. These can vary from the most basic tasks such as setting signals when turnouts are closed or thrown, to triggering complete automation sequences via a DCC accessory decoder.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../turntable-ex/index.html" class="btn btn-neutral float-right" title="Turntable-EX (Beta)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="EX-RAIL-summary.html" class="btn btn-neutral float-left" title="EX-RAIL Command Summary" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020-2022 - Fred Decker, Mani Kumar.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>