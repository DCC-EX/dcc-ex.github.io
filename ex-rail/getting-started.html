<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="DCC-EX is a team of dedicated enthusiasts producing, easy to use, affordable, do-it-yourself, open source, DCC solutions to allow you to run your complete model railroad layout." name="description" />
<meta content="DCC DCC++ EX DCC++EX DCC-EX" name="keywords" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Creating Automations &mdash; DCC-EX Model Railroading  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/dccex_theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/big_picture_theme.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/js/platform.js"></script>
        <script src="../_static/js/extra.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tips and Techniques" href="tips.html" />
    <link rel="prev" title="Overview" href="overview.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
            <a href="../index.html">
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../levels.html">Choose Your Comfort Level</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ex-commandstation/index.html">EX-CommandStation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ex-commandstation/get-started/index.html">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/get-started/purchasing.html">Purchasing Parts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/get-started/assembly.html">Initial Assembly</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/get-started/wifi-setup.html">Adding WiFi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/get-started/installer.html">Install the software</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/get-started/controllers.html">Choosing a Controller (Throttle)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/get-started/testing.html">Test your setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/get-started/diagnosing-issues.html">Diagnosing Issues (Troubleshooting)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ex-commandstation/advanced-setup/index.html">Advanced Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/advanced-setup/supported-microcontrollers/index.html">Supported Microcontrollers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/microcontrollers/arduino-mega.html">Arduino Mega Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/microcontrollers/arduino-uno.html">Arduino Uno Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/microcontrollers/nano.html">Arduino Nano Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/microcontrollers/nano-every.html">Nano Every</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/microcontrollers/teensy.html">Teensy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/microcontrollers/wifi-mega.html">Mega+WiFi Setup</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/advanced-setup/supported-motorboards/index.html">Supported Motor Drivers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/arduino-motor-shield.html">Arduino Motor Shield - 1.5A [RECOMMENDED]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/deek-robot-motor-shield.html">Deek-Robot - 1.5A [RECOMMENDED]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/L298N-motor-board-setup.html">L298N Motor Driver Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/IBT_2-motor-board-setup.html">IBT_2 BTS7960 Motor Board</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/IRF3205-motor-board-setup.html">IRF3205 Motor Driver Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ex-commandstation/advanced-setup/supported-motorboards/motor-board-config.html">Motor Driver Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ex-commandstation/advanced-setup/supported-motorboards/high-accuracy.html">High Accuracy Waveform Mode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/advanced-setup/supported-connections/index.html">Supported Connections</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../ex-commandstation/advanced-setup/supported-connections/direct.html">Direct Connection (USB)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ex-commandstation/advanced-setup/supported-connections/wifi-setup.html">WiFi Connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ex-commandstation/advanced-setup/supported-connections/ethernet.html">Ethernet Connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ex-commandstation/advanced-setup/supported-connections/bluetooth.html">Bluetooth Connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ex-commandstation/advanced-setup/supported-connections/jmri.html">JMRI Connection</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/advanced-setup/supported-wifi/index.html">Supported WiFi Shields and Boards</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/wifi-boards/makerfabs-esp8266.html">Makerfabs ESP8266 WiFi Shield (recommended)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/wifi-boards/duinopeak-esp8266.html">Duinopeak ESP8266 WiFi Expansion Board</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/wifi-boards/esp-01.html">ESP-01 and ESP-01s</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/wifi-boards/mega-wifi.html">Mega+WiFi Combo Board</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ex-commandstation/advanced-setup/supported-wifi/wifi-config.html">WiFi Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/advanced-setup/supported-ethernet/index.html">Supported Ethernet Boards</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/ethernet-boards/arduino-ethernet-shield-2.html">Arduino Ethernet Shield 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/ethernet-boards/wiznet-wiz850io.html">Wiznet WIZ850IO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/ethernet-boards/sunfounder-ethernet-shield.html">Sunfounder Ethernet Shield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/ethernet-boards/nano-ethernet-shield.html">Nano Ethernet Shield</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/advanced-setup/supported-bluetooth/index.html">Supported Bluetooth Boards</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/bluetooth-boards.html">Bluetooth Boards</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/advanced-setup/installation-options/index.html">Installation Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../ex-installer/index.html">Install using EX-Installer</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../ex-installer/installing.html">Using the Installer</a></li>
<li class="toctree-l5"><a class="reference internal" href="../ex-installer/testing.html">Testing your installation</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../ex-commandstation/advanced-setup/installation-options/arduino-ide.html">Install using the Arduino IDE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/advanced-setup/startup-config.html">Startup Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ex-commandstation/advanced-setup/controllers.html">Choosing a Controller (Throttle) - Advanced</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ex-installer/index.html">EX-Installer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ex-installer/installing.html">Using the Installer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ex-installer/testing.html">Testing your installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ex-webthrottle/index.html">EX-WebThrottle</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">EX-RAIL (Automation)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Creating Automations</a></li>
<li class="toctree-l2"><a class="reference internal" href="tips.html">Tips and Techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="EX-RAIL-summary.html">EX-RAIL Command Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="EX-RAIL-reference.html">EX-RAIL Command Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ex-turntable/index.html">EX-Turntable</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ex-turntable/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ex-turntable/purchasing.html">Purchasing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ex-turntable/assembly.html">Assembly &amp; Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ex-turntable/test-and-tune.html">Testing, Tuning, and Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ex-turntable/layout-wiring.html">Layout Connections and Wiring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ex-turntable/configure.html">Configuration options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ex-turntable/troubleshooting.html">Troubleshooting EX-Turntable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ex-turntable/traverser.html">Traversers and Limited Rotation Turntables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ex-dccinspector/index.html">EX-DCCInspector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../big-picture/index.html">The Big Picture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../big-picture/big-picture.html">How it All Works Together</a></li>
<li class="toctree-l2"><a class="reference internal" href="../big-picture/stage1.html">Stage 1 - Running a Train</a></li>
<li class="toctree-l2"><a class="reference internal" href="../big-picture/stage2.html">Stage 2 - Adding a Roster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../big-picture/stage3.html">Stage 3 - Turnouts/Points, Accessories, Sensors &amp; Blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../big-picture/stage4.html">Stage 4 - Automation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../big-picture/stage5.html">Stage 5 - Turntables &amp; Traversers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../big-picture/stage6.html">Stage 6 - Putting it all Together</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../big-picture/stage6/example1.html">Example 1 ROUTEs with turnouts/signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../big-picture/stage6/example2.html">Example 2 ROUTEs with turnouts/signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../big-picture/stage6/example3.html">Example 3 ROUTEs with turnouts/signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../big-picture/stage6/example4.html">Example 4 Full automation with turnouts &amp; signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../big-picture/stage6/example5.html">Example 5 Full automation with turnouts &amp; signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../big-picture/stage6/example6.html">Example 6 Full automation with turnouts &amp; signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../big-picture/stage6/example7.html">Example 7 Full automation with turnouts &amp; signals</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../throttles/index.html">Controllers (Throttles)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../throttles/protocols.html">WiThrottle Server, Web Server, DCC++ API Explained</a></li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/software/index.html">Throttles (Software)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../throttles/software/ex-webthrottle.html">EX-WebThrottle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../throttles/software/engine-driver.html">Engine Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../throttles/software/withrottle.html">WiThrottle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../throttles/software/dccpp-cab.html">DCCpp CAB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../throttles/software/locontrol.html">Locontrol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../throttles/software/cab-engineer.html">Cab Engineer: DCC Throttle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../throttles/software/digitrainspro.html">DigiTrainsPro</a></li>
<li class="toctree-l3"><a class="reference internal" href="../throttles/software/srcpclient.html">SRCP Client (iOS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../throttles/software/jmri.html">JMRI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/hardware/index.html">Throttles (Hardware)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../throttles/hardware/minithrottle.html">miniThrottle (Physical)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../throttles/hardware/witcontroller.html">WiTcontroller (Physical)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../throttles/hardware/physical-knobs.html">Adding a Physical Knob</a></li>
<li class="toctree-l3"><a class="reference internal" href="../throttles/hardware/streamdeck.html">Elgato Stream Deck</a></li>
<li class="toctree-l3"><a class="reference internal" href="../throttles/hardware/uwt50.html">TCS UWT-50 (Physical)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/tech-reference.html">Technical Reference for Throttle Developers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../download/index.html">Downloads</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../download/ex-commandstation.html">EX-CommandStation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download/esp8266.html">ESP8266 (WiFi Boards)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download/ex-dccinspector.html">EX-DCCInspector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download/ex-turntable.html">EX-Turntable</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../support/index.html">Contact &amp; Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../support/contact-us.html">Contact Us</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support/create-ticket.html">Submit a Support Ticket</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/videos/index.html">Videos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/downloads/index.html">Downloads</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/downloads/documents.html">Documents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/downloads/schematics.html">Schematics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/hardware/index.html">Hardware</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/microcontroller-boards.html">Microcontroller Boards</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/microcontrollers/arduino-mega.html">Arduino Mega Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/microcontrollers/arduino-uno.html">Arduino Uno Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/microcontrollers/nano.html">Arduino Nano Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/microcontrollers/nano-every.html">Nano Every</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/microcontrollers/teensy.html">Teensy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/microcontrollers/wifi-mega.html">Mega+WiFi Setup</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/motor-boards.html">Motor Boards</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/arduino-motor-shield.html">Arduino Motor Shield - 1.5A [RECOMMENDED]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/deek-robot-motor-shield.html">Deek-Robot - 1.5A [RECOMMENDED]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/flashtree-motor-shield.html">Flashtree - 1.5A</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/diy-more-l298nh-motor-shield.html">DIY More L298NH - 2A</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/yfrobot-l298p.html">YFRobot L298P - 2A</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/L298N-motor-board-setup.html">L298N (dual) - 2A</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/IRF3205-motor-board-setup.html">Dual Module H-bridge MOSFET IRF3205 - 15A</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/pololu-mc33926.html">Pololu MC33926 - 3A</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/miniibt-motor-driver-l6201p.html">MiniIBT L6201P (single) - 5A</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/IBT_2-motor-board-setup.html">BTS7960 IBT_2 (single) - 43A</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/keyes-fundumoto.html">Keyes/Fundumoto (&quot;Beeper Board&quot;) - 2A</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/makerfabs-h-bridge-motor-shield.html">Makerfabs H-Bridge - 8A</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/velleman-ka03-kit-vma03.html">Velleman KA03/VMA03 - 2A</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/motorboards/dfrobot-2x2a-dc-motor-shield.html">DFRobot 2x2A DC Motor Shield (DRI0009) - 2A</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/wifi-boards.html">WiFi Boards</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/wifi-boards/makerfabs-esp8266.html">Makerfabs ESP8266 WiFi Shield (recommended)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/wifi-boards/duinopeak-esp8266.html">Duinopeak ESP8266 WiFi Expansion Board</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/wifi-boards/esp-01.html">ESP-01 and ESP-01s</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/wifi-boards/wangtongze-board.html">WangTongze Board</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/wifi-boards/mega-wifi.html">Mega+WiFi Combo Board</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/wifi-boards/sparkfun-thing-plus.html">SparkFun Thing Plus (ESP32)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/wifi-boards/esp32-ant-01.html">ESP32_Ant-01 Breakout and Development Board (ESP32)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/ethernet-boards.html">Ethernet Boards</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/ethernet-boards/arduino-ethernet-shield-2.html">Arduino Ethernet Shield 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/ethernet-boards/wiznet-wiz850io.html">Wiznet WIZ850IO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/ethernet-boards/sunfounder-ethernet-shield.html">Sunfounder Ethernet Shield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/ethernet-boards/nano-ethernet-shield.html">Nano Ethernet Shield</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/index-ic2.html">iC2 Hardware</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/i2c-displays.html">I2C Displays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/i2c-devices.html">I2C Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/gpio-module.html">I2C GPIO Expander Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/servo-module.html">Connecting a Servo Module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/power-supplies.html">Power Supplies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/accessory-controllers.html">Accessory Controllers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/shopping-list.html">Shopping List</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/index-decoder.html">Decoders</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/decoder-list.html">List of Tested Decoders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/hardware/decoder-notes.html">Decoder Notes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/hardware/wire-gauge.html">DCC Track Wiring Information</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/software/index.html">DCC-EX Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/software/command-reference.html">DCC-EX Command Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/software/command-summary.html">DCC-EX Command Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/developers/index.html">Developer and API reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/developers/tech-reference.html">Technical Reference for Throttle Developers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/developers/api.html">CommandStation-EX API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/developers/hal.html">DCC-EX HAL Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/developers/hal-config.html">I/O Device Drivers and HAL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/developers/writing-hal-driver.html">Writing a HAL Driver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/accessories/index.html">DCC-EX Third Party Suppliers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/accessories/suppliers-full-cs.html">Full Command Stations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/accessories/suppliers-cases.html">Cases / Enclosures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/tools/index.html">Diagnostic Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/tools/serial-monitor.html">Using a Serial Monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/tools/index-diagnostics-d.html">Diagnostic d Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/tools/diagnostic-d-ack-command.html">Diagnostics <code class="docutils literal notranslate"><span class="pre">&lt;D</span> <span class="pre">ACK&gt;</span></code> Command</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/tools/diagnostic-d-command.html">Diagnostics <code class="docutils literal notranslate"><span class="pre">&lt;D&gt;</span></code> Command</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/tools/diagnostic-tools.html">DCC Diagnostic Tools</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../projects/index.html">Related Projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../projects/railsnail-bluetooth.html">RailSnail’s Complete Bluetooth EX-CommandStation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/hardware/minithrottle.html">miniThrottle (Physical)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/hardware/witcontroller.html">WiTcontroller (Physical)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../throttles/hardware/streamdeck.html">Elgato Stream Deck</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">About &amp; Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about/about.html">About Us - Meet the Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/press/index.html">Press / Announcements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../about/press/rewrite.html">DCC++ VS DCC-EX? [Oct 2022]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/press/v40-announce.html">EX-CommandStation 4.0 Release [Feb 2022]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/press/release-notes.html">Release Notes [Feb 2022]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/press/new-name.html">Our New Name [Aug 2022]</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about/contributing/donate.html">Donate to Our Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/contributing/index.html">Contributing - Helping the DCC-EX Team</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../about/contributing/overview.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/contributing/github.html">GitHub</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/contributing/requirements.html">What You Need to Know/Learn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/contributing/software.html">Recommended Software</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/contributing/development.html">Contributing to the Hardware &amp; Software</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/contributing/website/index.html">Contributing to the Documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../about/contributing/website/getting-started.html">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../about/contributing/website/structure.html">Folder and Page Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../about/contributing/website/basic-rst.html">ReStructuredText Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../about/contributing/website/style-guide.html">Style Guide</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about/licence.html">Licence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/roadmap.html">DCC-EX Roadmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/site-map.html">Site Map</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DCC-EX Model Railroading</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">EX-RAIL (Automation)</a> &raquo;</li>
      <li>Creating Automations</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/DCC-EX/dcc-ex.github.io/blob/flash62au_restruct/docs/ex-rail/getting-started.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><a class="image-float-right reference internal" href="../_images/product-logo-ex-rail.png"><img alt="EX-RAIL" class="image-float-right" src="../_images/product-logo-ex-rail.png" style="width: 320.0px; height: 64.0px;" /></a></p>
<section id="creating-automations">
<h1>Creating Automations<a class="headerlink" href="#creating-automations" title="Permalink to this heading"></a></h1>
<p><a class="reference external" href="../levels.html#tinkerer"><img alt="Propeller Beanie" src="../_images/tinkerer-level.png" style="width: 169.5px; height: 45.0px;" /></a> <a class="reference external" href="../levels.html#conductor"><img alt="Conductor Hat" src="../_images/conductor-level.png" style="width: 169.5px; height: 45.0px;" /></a></p>
<aside class="sidebar">
<div class="contents local topic" id="on-this-page">
<p class="topic-title">On this page</p>
<ul class="simple">
<li><p><a class="reference internal" href="#the-automation-process" id="id1">The Automation Process</a></p></li>
<li><p><a class="reference internal" href="#some-simple-examples" id="id2">Some Simple Examples</a></p>
<ul>
<li><p><a class="reference internal" href="#example-1-creating-routes-for-a-throttle" id="id3">Example 1: Creating Routes for a Throttle</a></p></li>
<li><p><a class="reference internal" href="#example-2-automating-signals-with-turnouts" id="id4">Example 2: Automating Signals with Turnouts</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#defining-turnouts" id="id5">Defining Turnouts</a></p></li>
<li><p><a class="reference internal" href="#defining-signals" id="id6">Defining Signals</a></p>
<ul>
<li><p><a class="reference internal" href="#example-3-automating-various-non-track-items" id="id7">Example 3: Automating various non-track items</a></p></li>
<li><p><a class="reference internal" href="#example-4-automating-a-train-simple-loop" id="id8">Example 4: Automating a train (simple loop)</a></p></li>
<li><p><a class="reference internal" href="#example-5-signals-in-a-train-script" id="id9">Example 5: Signals in a train script</a></p></li>
<li><p><a class="reference internal" href="#example-6-single-line-shuttle" id="id10">Example 6: Single line shuttle</a></p></li>
<li><p><a class="reference internal" href="#example-7-running-multiple-inter-connected-trains" id="id11">Example 7: Running multiple inter-connected trains</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#starting-the-system" id="id12">Starting the system</a></p></li>
<li><p><a class="reference internal" href="#drive-away-feature" id="id13">Drive-Away feature</a></p></li>
<li><p><a class="reference internal" href="#roster-entries" id="id14">Roster entries</a></p></li>
<li><p><a class="reference internal" href="#sounds" id="id15">Sounds</a></p></li>
<li><p><a class="reference internal" href="#sensors" id="id16">Sensors</a></p></li>
<li><p><a class="reference internal" href="#outputs" id="id17">Outputs</a></p></li>
<li><p><a class="reference internal" href="#sequence-numbers" id="id18">Sequence Numbers</a></p></li>
</ul>
</div>
</aside>
<section id="the-automation-process">
<h2><a class="toc-backref" href="#id1">The Automation Process</a><a class="headerlink" href="#the-automation-process" title="Permalink to this heading"></a></h2>
<p>Once started, all sequences step through a list of simple keywords until they reach a <code class="docutils literal notranslate"><span class="pre">DONE</span></code> keyword.</p>
<p>There can be a startup sequence (keywords at the beginning of the script), which if present is automatically executed, as are any sequences that contain an <code class="docutils literal notranslate"><span class="pre">AUTOSTART</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is an implied AUTOSTART whereby everything in myAutomation.h prior to the first <code class="docutils literal notranslate"><span class="pre">DONE</span></code> keyword is executed on startup. If you don’t wish anything to happen at startup, simply add the keyword <code class="docutils literal notranslate"><span class="pre">DONE</span></code> as the first line.</p>
</div>
<p>Multiple concurrent sequences are supported.</p>
<p>For a full list of keywords, see <a class="reference internal" href="EX-RAIL-summary.html"><span class="doc">EX-RAIL Command Summary</span></a>, and for further detailed information, see the <a class="reference internal" href="EX-RAIL-reference.html"><span class="doc">EX-RAIL Command Reference</span></a>.</p>
<p>The script containing your sequences is added to your Command Station by creating a file called “myAutomation.h” in the same folder as CommandStation-EX.ino.</p>
<p>Connecting your Arduino and pressing the Upload button in the usual way will save the file and upload your script into the Command Station.</p>
<p>To create the myAutomation.h file in the Arduino IDE, use the pulldown button and select New Tab (or simply press Ctrl+Shift+N).</p>
<a class="reference internal image-reference" href="../_images/setup1.jpg"><img alt="Setup pulldown button" class="align-center" src="../_images/setup1.jpg" style="width: 158.0px; height: 90.0px;" /></a>
<a class="reference internal image-reference" href="../_images/setup2.jpg"><img alt="Setup pulldown menu" class="align-center" src="../_images/setup2.jpg" style="width: 280.0px; height: 86.0px;" /></a>
<p>Enter the file name “myAutomation.h” (This is case sensitive)</p>
<a class="reference internal image-reference" href="../_images/setup3.jpg"><img alt="Setup myAutomation.h" class="align-center" src="../_images/setup3.jpg" style="width: 296.0px; height: 112.0px;" /></a>
<p>And type your script in.</p>
<a class="reference internal image-reference" href="../_images/setup4.jpg"><img alt="Setup Example file" class="align-center" src="../_images/setup4.jpg" style="width: 436.0px; height: 258.0px;" /></a>
</section>
<section id="some-simple-examples">
<h2><a class="toc-backref" href="#id2">Some Simple Examples</a><a class="headerlink" href="#some-simple-examples" title="Permalink to this heading"></a></h2>
<section id="example-1-creating-routes-for-a-throttle">
<h3><a class="toc-backref" href="#id3">Example 1: Creating Routes for a Throttle</a><a class="headerlink" href="#example-1-creating-routes-for-a-throttle" title="Permalink to this heading"></a></h3>
<p>A typical Route might be used to set a series of turnouts in response to a single button in a throttle.
The EX-RAIL instructions to do this might look like</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ROUTE</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;Coal Yard exit&quot;</span><span class="p">)</span>
  <span class="n">THROW</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">CLOSE</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
  <span class="n">DONE</span>
</pre></div>
</div>
<p>Or you can write it like this</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ROUTE</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;Coal Yard exit&quot;</span><span class="p">)</span>  <span class="n">THROW</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="n">CLOSE</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="n">DONE</span>
</pre></div>
</div>
<p>Or add comments</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// This is my coal yard to engine shed route</span>
  <span class="n">ROUTE</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;Coal Yard exit&quot;</span><span class="p">)</span>     <span class="c1">// appears in the throttle</span>
    <span class="n">THROW</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   <span class="c1">// throw turnout onto coal yard siding</span>
    <span class="n">CLOSE</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>   <span class="c1">// close turnout for engine shed</span>
    <span class="n">DONE</span>    <span class="c1">// that&#39;s all folks!</span>
</pre></div>
</div>
<p>Of course, you may want to add signals, and time delays</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">SIGNAL</span><span class="p">(</span><span class="mi">77</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">79</span><span class="p">)</span>  <span class="c1">// see the Defining Signals section</span>
<span class="n">SIGNAL</span><span class="p">(</span><span class="mi">92</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">93</span><span class="p">)</span>   <span class="c1">//      below for details</span>

<span class="n">ROUTE</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;Coal Yard exit&quot;</span><span class="p">)</span>
   <span class="n">RED</span><span class="p">(</span><span class="mi">77</span><span class="p">)</span>
   <span class="n">THROW</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   <span class="n">CLOSE</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
   <span class="n">DELAY</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>  <span class="c1">// this is a 5 second wait</span>
   <span class="n">GREEN</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span>
   <span class="n">DONE</span>
</pre></div>
</div>
</section>
<section id="example-2-automating-signals-with-turnouts">
<h3><a class="toc-backref" href="#id4">Example 2: Automating Signals with Turnouts</a><a class="headerlink" href="#example-2-automating-signals-with-turnouts" title="Permalink to this heading"></a></h3>
<p>By intercepting a turnout change command, it’s easy to automatically adjust signals or
automatically switch an adjacent facing turnout. Use an <code class="docutils literal notranslate"><span class="pre">ONTHROW</span></code> or <code class="docutils literal notranslate"><span class="pre">ONCLOSE</span></code> keyword to detect a particular turnout change:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ONTHROW</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="c1">// When turnout 8 is thrown,</span>
   <span class="n">THROW</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>  <span class="c1">// must also throw the facing turnout</span>
   <span class="n">RED</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
   <span class="n">DELAY</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
   <span class="n">GREEN</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
   <span class="n">DONE</span>

<span class="n">ONCLOSE</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="c1">// When turnout 8 is closed</span>
  <span class="n">CLOSE</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
  <span class="n">RED</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
  <span class="n">DELAY</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
  <span class="n">GREEN</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
  <span class="n">DONE</span>
</pre></div>
</div>
</section>
</section>
<section id="defining-turnouts">
<h2><a class="toc-backref" href="#id5">Defining Turnouts</a><a class="headerlink" href="#defining-turnouts" title="Permalink to this heading"></a></h2>
<p><span style="font-weight: bold; color: #00a3b9; font-size: 110%;">EX<span style="color: #00353d;">&#8209;CommandStation</span></span> supports a number of different turnout hardware configurations, but your automation treats them all as simple ID numbers. Turnouts may be defined using <code class="docutils literal notranslate"><span class="pre">&lt;T&gt;</span></code> commands from JMRI, or in <code class="docutils literal notranslate"><span class="pre">SETUP(&quot;&lt;T</span> <span class="pre">...&gt;&quot;)</span></code> commands placed in your mySetup.h file, or C++ code in mySetup.h, just like earlier versions.</p>
<p>You may, however, find it more convenient to define turnouts using EX-RAIL commands, which may appear anywhere in the ‘myAutomation.h’ file, even after they are referenced in an <code class="docutils literal notranslate"><span class="pre">ONTHROW</span></code>, <code class="docutils literal notranslate"><span class="pre">ONCLOSE</span></code>, <code class="docutils literal notranslate"><span class="pre">THROW</span></code> or <code class="docutils literal notranslate"><span class="pre">CLOSE</span></code> command. (EXRAIL extracts the turnout definitions just once from your script at Command Station startup.)</p>
<p>Turnouts defined in ‘myAutomation.h’ will still be visible to WiThrottle and JMRI in the normal way.</p>
<p>A TURNOUT sends DCC signals to a decoder attached to the track, a PIN_TURNOUT sends a “throw” or “close” (5V or 0V signal) to a pin on the Arduino, and a SERVO_TURNOUT sends an I2C serial command to a servo board connected to your servos.</p>
<p>See the <a class="reference internal" href="EX-RAIL-summary.html"><span class="doc">EX-RAIL Command Summary</span></a> page for TURNOUT, PIN_TURNOUT and SERVO_TURNOUT definitions.</p>
</section>
<section id="defining-signals">
<h2><a class="toc-backref" href="#id6">Defining Signals</a><a class="headerlink" href="#defining-signals" title="Permalink to this heading"></a></h2>
<p>Signals can now simply be a decoration to be switched by the route process; they don’t need to control anything.</p>
<p><code class="docutils literal notranslate"><span class="pre">GREEN(55)</span></code> would turn signal 55 green, and <code class="docutils literal notranslate"><span class="pre">RED(55)</span></code> would turn it red. Somewhere in the script there must be a SIGNAL command like this: <code class="docutils literal notranslate"><span class="pre">SIGNAL(55,56,57)</span></code>.  This defines a signal with ID 55, where the Red/Stop lamp is connected to pin 55, the Amber/Caution lamp to pin 56, and the Green/Proceed lamp to pin 57. The pin allocations do not need to be contiguous, and the red pin number is also used as the signal ID. Thus you can change the signal by <code class="docutils literal notranslate"><span class="pre">RED(55)</span></code>, <code class="docutils literal notranslate"><span class="pre">AMBER(55)</span></code>, or <code class="docutils literal notranslate"><span class="pre">GREEN(55)</span></code>. This means you don’t have to manually turn off the other lamps. A RED/GREEN only signal may be created with a zero amber pin.</p>
<section id="example-3-automating-various-non-track-items">
<h3><a class="toc-backref" href="#id7">Example 3: Automating various non-track items</a><a class="headerlink" href="#example-3-automating-various-non-track-items" title="Permalink to this heading"></a></h3>
<p>This normally takes place in a timed loop, for example alternate flashing of a fire engine’s lights. To do this use a SEQUENCE.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">SEQUENCE</span><span class="p">(</span><span class="mi">66</span><span class="p">)</span>
  <span class="n">SET</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>   <span class="c1">// sets output 101 HIGH</span>
  <span class="n">RESET</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span> <span class="c1">// sets output 102 LOW</span>
  <span class="n">DELAY</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>   <span class="c1">// wait 0.5 seconds</span>
  <span class="n">SET</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>   <span class="c1">// swap the lights</span>
  <span class="n">RESET</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
  <span class="n">DELAY</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>   <span class="c1">// wait 0.5 seconds</span>
  <span class="n">FOLLOW</span><span class="p">(</span><span class="mi">66</span><span class="p">)</span>  <span class="c1">// follow sequence 66 continuously</span>
</pre></div>
</div>
<p>Note, however, that this sequence will not start automatically: it must be started during the startup process (see later) using <code class="docutils literal notranslate"><span class="pre">START(66)</span></code>.</p>
</section>
<section id="example-4-automating-a-train-simple-loop">
<h3><a class="toc-backref" href="#id8">Example 4: Automating a train (simple loop)</a><a class="headerlink" href="#example-4-automating-a-train-simple-loop" title="Permalink to this heading"></a></h3>
<p>Start with something as simple as a single loop of track with a station and a sensor (connected to pin 40 for this example) at the point where you want the train to stop.</p>
<a class="reference internal image-reference" href="../_images/Example_4_diagram.png"><img alt="Simple example 4" class="align-center" src="../_images/Example_4_diagram.png" style="width: 915.0px; height: 191.0px;" /></a>
<p>Using an <code class="docutils literal notranslate"><span class="pre">AUTOMATION</span></code> keyword means that this automation will appear in the throttle so you can drive the train manually, and then hand it over to the automation at the press of a button.</p>
<p>* Technically, an automation can independently run multiple locos along the same path through the layout, but this is discussed later…</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">AUTOMATION</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s">&quot;Round in circles&quot;</span><span class="p">)</span>
   <span class="n">FWD</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>   <span class="c1">// move forward at DCC speed 50 (out of 127)</span>
   <span class="n">AT</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>     <span class="c1">// when you get to sensor on pin (40)</span>
   <span class="n">STOP</span>      <span class="c1">// stop the train</span>
   <span class="n">DELAYRANDOM</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span><span class="mi">20000</span><span class="p">)</span> <span class="c1">// delay somewhere between 5 and 20 seconds</span>
   <span class="n">FWD</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>   <span class="c1">// start a bit slower</span>
   <span class="n">AFTER</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>  <span class="c1">// until sensor on pin 40 has been passed</span>
   <span class="n">FOLLOW</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c1">// and continue to follow the automation</span>
</pre></div>
</div>
<p>The instructions are followed in sequence by the loco given to it; the <code class="docutils literal notranslate"><span class="pre">AT</span></code> command just leaves the loco running until that sensor is detected.</p>
<p>Notice that this automation does not specify the loco address. If you drive a loco with the throttle and then hand it over to this automation, then the automation will run with the loco you last drove.</p>
</section>
<section id="example-5-signals-in-a-train-script">
<h3><a class="toc-backref" href="#id9">Example 5: Signals in a train script</a><a class="headerlink" href="#example-5-signals-in-a-train-script" title="Permalink to this heading"></a></h3>
<p>Adding a station signal to the loop script is extremely simple, but it does require a mind-shift for some modellers who like to think in terms of signals being in control of trains! EX-RAIL takes a different approach, by animating the signals as part of the driving script. Thus set a signal GREEN before moving off (and allow a little delay for the driver to react) and RED after you have passed it.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">SIGNAL</span><span class="p">(</span><span class="mi">77</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">79</span><span class="p">)</span>  <span class="c1">// see the Defining Signals section above for details</span>
<span class="n">AUTOMATION</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s">&quot;Round in circles&quot;</span><span class="p">)</span>
   <span class="n">FWD</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>   <span class="c1">// move forward at DCC speed 50 (out of 127)</span>
   <span class="n">AT</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>    <span class="c1">// when you get to sensor on pin (40)</span>
   <span class="n">STOP</span>      <span class="c1">// Stop the train</span>
   <span class="n">DELAYRANDOM</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span><span class="mi">20000</span><span class="p">)</span> <span class="c1">// delay somewhere between 5 and 20 seconds</span>
   <span class="n">GREEN</span><span class="p">(</span><span class="mi">77</span><span class="p">)</span>    <span class="c1">// set signal #77 to Green</span>
   <span class="n">DELAY</span><span class="p">(</span><span class="mi">2500</span><span class="p">)</span>  <span class="c1">// This is not Formula1!</span>
   <span class="n">FWD</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>    <span class="c1">// start a bit slower</span>
   <span class="n">AFTER</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>  <span class="c1">// until sensor on pin 40 has been passed</span>
   <span class="n">RED</span><span class="p">(</span><span class="mi">77</span><span class="p">)</span>    <span class="c1">// set signal #77 to Red</span>
   <span class="n">FOLLOW</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c1">// and continue to follow the automation</span>
</pre></div>
</div>
</section>
<section id="example-6-single-line-shuttle">
<h3><a class="toc-backref" href="#id10">Example 6: Single line shuttle</a><a class="headerlink" href="#example-6-single-line-shuttle" title="Permalink to this heading"></a></h3>
<p>Consider a single line, shuttling between stations A and B.</p>
<a class="reference internal image-reference" href="../_images/Example_6_diagram.png"><img alt="Simple example 4" class="align-center" src="../_images/Example_6_diagram.png" style="width: 944.0px; height: 188.0px;" /></a>
<p>Starting from Station A, the steps may be something like:</p>
<ul class="simple">
<li><p>Wait between 10 and 20 seconds for the guard to stop chatting up the girl in the ticket office.</p></li>
<li><p>Move forward at speed 30</p></li>
<li><p>When I get to B, stop.</p></li>
<li><p>Wait 15 seconds for the tea trolley to be restocked</p></li>
<li><p>Move backwards at speed 20</p></li>
<li><p>When I get to A, stop.</p></li>
</ul>
<p>Notice that the sensors at A and B are near the ends of the track (allowing for braking distance, but don’t care about train length or whether the engine is at the front or back.) We have wired sensor A on pin 41, and sensor B on pin 42 for this example.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">SEQUENCE</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
  <span class="n">DELAYRANDOM</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span><span class="mi">20000</span><span class="p">)</span> <span class="c1">// random wait between 10 and 20 seconds</span>
  <span class="n">FWD</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
  <span class="n">AT</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="c1">// sensor 42 is at the far end of platform B</span>
  <span class="n">STOP</span>
  <span class="n">DELAY</span><span class="p">(</span><span class="mi">15000</span><span class="p">)</span>
  <span class="n">REV</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="c1">// Reverse at DCC speed 20 (out of 127)</span>
  <span class="n">AT</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span> <span class="c1">// far end of platform A</span>
  <span class="n">STOP</span>
  <span class="n">FOLLOW</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="c1">// follows sequence 13 again… forever</span>
</pre></div>
</div>
<p>Note a SEQUENCE is exactly the same as an AUTOMATION except that it does NOT appear in the throttle.</p>
<p>When the Command Station is powered up or reset, EX-RAIL starts operating at the beginning of the file.  For this sequence we need to set a loco address and start the sequence:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">SENDLOCO</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span> <span class="c1">// Start sequence 13 using loco 3</span>
<span class="n">DONE</span>           <span class="c1">// This marks the end of the startup process</span>
</pre></div>
</div>
<p>The sequence can also be started from a serial monitor with the command <code class="docutils literal notranslate"><span class="pre">&lt;/</span> <span class="pre">START</span> <span class="pre">3</span> <span class="pre">13&gt;</span></code>.</p>
<p>If you have multiple separate sections of track which do not require inter-train cooperation, you may add many more separate sequences and they will operate independently.</p>
<p>Although the above is trivial, the routes are designed to be independent of the loco address so that we can have several locos following the same route at the same time (not in the end to end example above!), perhaps passing each other or crossing over with trains on other routes.</p>
<p>The example above assumes that loco 3 is sitting on the track and pointing in the right direction. A bit later you will see how to script an automatic process to take whatever loco is placed on the programming track, and send it on its way to join in the fun!</p>
</section>
<section id="example-7-running-multiple-inter-connected-trains">
<h3><a class="toc-backref" href="#id11">Example 7: Running multiple inter-connected trains</a><a class="headerlink" href="#example-7-running-multiple-inter-connected-trains" title="Permalink to this heading"></a></h3>
<p>So what about routes that cross or share single lines (passing places etc)?
Let’s add a passing place between A and B. S= Sensors, T=Turnout
number. So now our route looks like this:</p>
<a class="reference internal image-reference" href="../_images/Example_7a_diagram.png"><img alt="Simple example 4" class="align-center" src="../_images/Example_7a_diagram.png" style="width: 944.0px; height: 188.0px;" /></a>
<p>Assuming that you have defined your turnouts with <a class="reference internal" href="EX-RAIL-summary.html#automations-routes-and-sequences"><span class="std std-ref">TURNOUT commands.</span></a></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">SEQUENCE</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
   <span class="n">DELAYRANDOM</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span><span class="mi">20000</span><span class="p">)</span> <span class="c1">// random wait between 10 and 20 seconds</span>
   <span class="n">CLOSE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   <span class="n">CLOSE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
   <span class="n">FWD</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
   <span class="n">AT</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="c1">// sensor 42 is at the far end of platform B</span>
   <span class="n">STOP</span>
   <span class="n">DELAY</span><span class="p">(</span><span class="mi">15000</span><span class="p">)</span>
   <span class="n">THROW</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
   <span class="n">THROW</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   <span class="n">REV</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
   <span class="n">AT</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span>
   <span class="n">STOP</span>
   <span class="n">FOLLOW</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c1">// follows sequence 11 again… forever</span>
</pre></div>
</div>
<p>All well and good for one loco, but with 2 (or even 3) on this track we need some rules. The principle behind this is</p>
<ul class="simple">
<li><p>To enter a section of track that may be shared, you must RESERVE it. If you cant reserve it because another loco already has, then you will be stopped and the script will wait until such time as you can reserve it. When you leave a shared section you must free it.</p></li>
<li><p>Each “section” is merely a logical concept, there are no electronic section breaks in the track. You may have up to 255 sections (more can be supported by a code mod if required).</p></li>
</ul>
<p>So we will need some extra sensors (hardware required) and some logical blocks (all in the mind!):</p>
<a class="reference internal image-reference" href="../_images/Example_7b_diagram.png"><img alt="Simple example 4" class="align-center" src="../_images/Example_7b_diagram.png" style="width: 944.0px; height: 188.0px;" /></a>
<p>We can use this diagram to plan routes. When we do so, it will be easier to imagine 4 separate mini routes, each passing from one block to the next. Then we can chain them together to form a full route, but also start from any block.</p>
<p>So… lets take a look at the routes now. For convenience I have used route numbers that help remind us what the route is for.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">SEQUENCE</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="c1">// From block 1 to block 2</span>
   <span class="n">DELAYRANDOM</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span><span class="mi">20000</span><span class="p">)</span> <span class="c1">// random wait between 10 and 20 seconds</span>
   <span class="n">RESERVE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1">// we wish to enter block 2… so wait for it</span>
   <span class="n">CLOSE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">// Now we “own” the block, set the turnout</span>
   <span class="n">FWD</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="c1">// and proceed forward</span>
   <span class="n">AFTER</span><span class="p">(</span><span class="mi">71</span><span class="p">)</span> <span class="c1">// Once we have reached AND passed sensor 71</span>
   <span class="n">FREE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">// we no longer occupy block 1</span>
   <span class="n">AT</span><span class="p">(</span><span class="mi">72</span><span class="p">)</span> <span class="c1">// When we get to sensor 72</span>
   <span class="n">FOLLOW</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="c1">// follow route from block 2 to block 3</span>

<span class="n">SEQUENCE</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="c1">// Travel from block 2 to block 3</span>
   <span class="n">RESERVE</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1">// will STOP if block 3 occupied</span>
   <span class="n">CLOSE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1">// Now we have the block, we can set turnouts</span>
   <span class="n">FWD</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="c1">// we may or may not have stopped at the RESERVE</span>
   <span class="n">AT</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="c1">// sensor 2 is at the far end of platform B</span>
   <span class="n">STOP</span>
   <span class="n">FREE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
   <span class="n">DELAY</span><span class="p">(</span><span class="mi">15000</span><span class="p">)</span>
   <span class="n">FOLLOW</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span>

<span class="n">SEQUENCE</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span> <span class="c1">// you get the idea</span>
   <span class="n">RESERVE</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
   <span class="n">THROW</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
   <span class="n">REV</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
   <span class="n">AFTER</span><span class="p">(</span><span class="mi">73</span><span class="p">)</span>
   <span class="n">FREE</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
   <span class="n">AT</span><span class="p">(</span><span class="mi">74</span><span class="p">)</span>
   <span class="n">FOLLOW</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span>

<span class="n">SEQUENCE</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span>
   <span class="n">RESERVE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   <span class="n">THROW</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   <span class="n">REV</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
   <span class="n">AT</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span>
   <span class="n">STOP</span>
   <span class="n">FREE</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
   <span class="n">FOLLOW</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="c1">// follows Route 12 again… forever</span>
</pre></div>
</div>
<p>Does that look long? Worried about memory on your Arduino…. Well the script above takes about 100 BYTES of program memory and no dynamic SRAM!</p>
<p>If you follow this example carefully, you’ll see it allows for up to 3 trains at a time, because one of them will always have somewhere to go. Notice that there is a common theme to this…</p>
<ul class="simple">
<li><p>RESERVE where you want to go. If you are moving and the reserve fails, your loco will STOP and the reserve waits for the block to become available. *These waits and the manual WAITS do not block the Arduino process… DCC and the other locos continue to follow their routes!</p></li>
<li><p>Set the points to enter the reserved area. Do this ASAP, as you may be still moving towards them.</p></li>
<li><p>Set any signals.</p></li>
<li><p>Move into the reserved area.</p></li>
<li><p>Reset your signals.</p></li>
<li><p>Free off your previous reserve as soon as you have fully left the block.</p></li>
</ul>
<p>In addition, it is possible to take decisions based on blocks reserved by other trains. The IFRESERVE(block) can be used to reserve a block if it’s not already reserved by some other train, or skip to the matching ENDIF. For example, this allows a train to choose which platform to stop at based on prior occupancy. It is features like this that allow for more interesting and unpredictable automations.</p>
</section>
</section>
<section id="starting-the-system">
<h2><a class="toc-backref" href="#id12">Starting the system</a><a class="headerlink" href="#starting-the-system" title="Permalink to this heading"></a></h2>
<p>Starting the system is tricky, because we need to place the trains in a suitable position and set them going. We need to have a starting position for each loco, and reserve the block(s) it needs to keep other trains from crashing into it.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This EX-RAIL version isn’t ready to handle locos randomly placed on the layout after a power down!</p>
</div>
<p>For a known set of locos, the easiest way is to define the startup process at the beginning of the script. E.g. for two engines, one at each station.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// ensure all blocks are reserved as if the locos had arrived there</span>
<span class="n">RESERVE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">// start with a loco in block 1</span>
<span class="n">RESERVE</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1">// and another in block 3</span>
<span class="n">SENDLOCO</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span> <span class="c1">// send Loco DCC addr 3 on to route 12</span>
<span class="n">SENDLOCO</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">34</span><span class="p">)</span> <span class="c1">// send loco DCC addr 17 to route 34</span>
<span class="n">DONE</span> <span class="c1">// don&#39;t drop through to the first sequence definition that follows in the script file</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Some interesting points about the startup:</p>
<ul class="simple">
<li><p>You don’t need to set turnouts, because each route is setting them as required.</p></li>
<li><p>Signals default to RED on power up, and get turned GREEN when a route clears them.</p></li>
</ul>
</div>
</section>
<section id="drive-away-feature">
<h2><a class="toc-backref" href="#id13">Drive-Away feature</a><a class="headerlink" href="#drive-away-feature" title="Permalink to this heading"></a></h2>
<p>EX-RAIL can switch a track section between programming and mainline.</p>
<p>Here for example is a launch sequence that has no predefined locos but allows locos to be added at station 1 while the system is in motion. Let’s assume that the track section at Station1 is isolated and connected to the programming track power supply. Also that we have a “launch” button connected where sensor 17 would be and an optional signal (i.e. 3 LEDs) on the control panel connected where signal 27 would be.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">SEQUENCE</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
  <span class="n">SIGNAL</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">29</span><span class="p">)</span>
  <span class="n">RED</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>   <span class="c1">// indicate launch not ready</span>
  <span class="n">AFTER</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="c1">// user presses and releases launch button</span>
  <span class="n">UNJOIN</span>    <span class="c1">// separate the programming track from main</span>
  <span class="n">DELAY</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
  <span class="n">AMBER</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="c1">// Show amber, user may place loco</span>
  <span class="n">AFTER</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="c1">// user places loco on track and presses “launch” again</span>
  <span class="n">READ_LOCO</span> <span class="c1">// identify the loco</span>
  <span class="n">GREEN</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="c1">// show green light to user</span>
  <span class="n">JOIN</span>      <span class="c1">// connect prog track to main</span>
  <span class="n">START</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="c1">// send loco off along route 12</span>
  <span class="n">FOLLOW</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span> <span class="c1">// keep doing this for another launch</span>
</pre></div>
</div>
<p>The READ_LOCO reads the loco address from the PROG track and the current route takes on that loco. By altering the script slightly and adding another sensor, it’s possible to detect which way the loco sets off and switch the code logic to send it in the correct direction by using the INVERT_DIRECTION instruction so that this locos FWD and REV commands are reversed. (easily done with diesels!)</p>
</section>
<section id="roster-entries">
<h2><a class="toc-backref" href="#id14">Roster entries</a><a class="headerlink" href="#roster-entries" title="Permalink to this heading"></a></h2>
<p>EX-RAIL has a ROSTER() function to allow you to define all of your locomotives with a list of their defined functions which is advertised to WiThrottle applications, just like turnouts and routes.</p>
<p>The functions can simply be listed as “F” numbers, or you can provide a text description of the function. Prefacing the function with a “*” indicates it is momentary, meaning it is only activated while holding that function button down.</p>
<p>A very simple roster entry for a loco with ID 1506 called “HUSA” with three functions of light, bell, and momentary horn would look like this:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ROSTER</span><span class="p">(</span><span class="mi">1506</span><span class="p">,</span> <span class="s">&quot;HUSA&quot;</span><span class="p">,</span> <span class="s">&quot;Light/Bell/*Horn&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>A more complex example with generic functions for the same loco (note the momentary F2 for horn):</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ROSTER</span><span class="p">(</span><span class="mi">1506</span><span class="p">,</span> <span class="s">&quot;HUSA&quot;</span><span class="p">,</span> <span class="s">&quot;F0/F1/*F2/F3/F4/F5/F6/F7/F8/F9/F10/F11/F12/F13/F14/F15/F16/F17/F18/F19/F20/F21/F22/F23/F24/F25/F26/F27/F28&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The same again, with more text functions defined to represent a number of different sounds:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ROSTER</span><span class="p">(</span><span class="mi">1506</span><span class="p">,</span> <span class="s">&quot;HUSA&quot;</span><span class="p">,</span> <span class="s">&quot;Lights/Bell/*Horn/Air/Brake/Coupling/Compressor/Sand/Mute/F9/F10/F11/F12/F13/F14/F15/F16/F17/F18/F19/F20/F21/F22/F23/F24/F25/F26/F27/F28&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sounds">
<h2><a class="toc-backref" href="#id15">Sounds</a><a class="headerlink" href="#sounds" title="Permalink to this heading"></a></h2>
<p>You can use <code class="docutils literal notranslate"><span class="pre">FON(n)</span></code> and <code class="docutils literal notranslate"><span class="pre">FOFF(n)</span></code> to switch loco functions… eg sound horn.</p>
</section>
<section id="sensors">
<h2><a class="toc-backref" href="#id16">Sensors</a><a class="headerlink" href="#sensors" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><span style="font-weight: bold; color: #00a3b9; font-size: 110%;">EX<span style="color: #00353d;">&#8209;CommandStation</span></span> allows for sensors that are <strong>Active Low or Active High</strong>. This is particularly important for IR sensors that have been converted to detect by broken beam, rather than reflection. By making the sensor number negative, the sensor state is inverted. e.g. <code class="docutils literal notranslate"><span class="pre">AT(-5)</span></code>.</p></li>
<li><p>Magnetic/Hall effect sensors work for some layouts, but beware of how you detect the back end of a train approaching the buffers in a siding, or knowing when the last car has cleared a crossing.</p></li>
<li><p>Handling sensors in the automation is made easy because EX-RAIL throws away the concept of interrupts (“oh… sensor 5 has been detected… which loco was that and whatever do I do now?”) and instead has the sequences work on the basis of “do nothing, maintain speed until sensor 5 triggers, and then carry on in the script”.</p></li>
<li><p>Sensor numbers are direct references to VPINs (virtual pin numbers) in the Hardware Abstraction Layer. For a Mega onboard GPIO pin, this is the same as the digital pin number. Other pin ranges refer to I/O expanders etc.</p></li>
<li><p>Sensors with ID’s 0 to 255 may be LATCHED/UNLATCHED in your script. If a sensor is latched on by the script, it can only be set off by the script… so <code class="docutils literal notranslate"><span class="pre">AT(5)</span> <span class="pre">LATCH(5)</span></code> for example effectively latches the sensor 5 on when detected once.</p></li>
<li><p>Sensor polling by JMRI is independent of this, and may continue if <code class="docutils literal notranslate"><span class="pre">&lt;S&gt;</span></code> commands are used.</p></li>
</ul>
</section>
<section id="outputs">
<h2><a class="toc-backref" href="#id17">Outputs</a><a class="headerlink" href="#outputs" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Generic Outputs are mapped to VPINs on the HAL (as for sensors)</p></li>
<li><p>SIGNAL definitions are just groups of 3 Output pins that can be more easily managed.</p></li>
</ul>
</section>
<section id="sequence-numbers">
<h2><a class="toc-backref" href="#id18">Sequence Numbers</a><a class="headerlink" href="#sequence-numbers" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>All ROUTE / AUTOMATION / SEQUENCE ids are limited to 1 - 32767</p></li>
<li><p>0 is reserved for the startup sequence appearing as the first entry in the EXRAIL script.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="overview.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tips.html" class="btn btn-neutral float-right" title="Tips and Techniques" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2022 - Fred Decker, Mani Kumar.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>